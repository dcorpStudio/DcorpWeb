window.__require=function e(t,i,a){function o(s,l){if(!i[s]){if(!t[s]){var r=s.split("/");if(r=r[r.length-1],!t[r]){var c="function"==typeof __require&&__require;if(!l&&c)return c(r,!0);if(n)return n(r,!0);throw new Error("Cannot find module '"+s+"'")}s=r}var u=i[s]={exports:{}};t[s][0].call(u.exports,function(e){return o(t[s][1][e]||e)},u,u.exports,e,t,i,a)}return i[s].exports}for(var n="function"==typeof __require&&__require,s=0;s<a.length;s++)o(a[s]);return o}({all_modules:[function(e,t,i){"use strict";cc._RF.push(t,"729f19Hu2ZJ9ZSyZWzvBjRv","all_modules");var a=this&&this.__createBinding||(Object.create?function(e,t,i,a){void 0===a&&(a=i),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[i]}})}:function(e,t,i,a){void 0===a&&(a=i),e[a]=t[i]}),o=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||a(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),i.types=void 0,o(e("../services/utils/utils_common"),i),o(e("../services/utils/utils_data"),i),o(e("../services/utils/utils_ui"),i),o(e("../services/utils/utils_anim_fx"),i),i.types=e("./system_types"),o(e("../services/audio/audio"),i),o(e("../system/app_events"),i),o(e("../system/login"),i),o(e("../core-game/graphic_lib"),i),o(e("../core-game/level_manager"),i),o(e("../system/resources_manager"),i),o(e("../core-game/control"),i),o(e("../core-game/map_visual"),i),o(e("../core-game/core_game"),i),o(e("../core-game/game_flow"),i),o(e("../core-game/user_model"),i),o(e("../system/configurations/config_anim_fx"),i),o(e("../core-game/ui-gameplay/core_ui"),i),o(e("../core-game/ui-gameplay/core_fx"),i),o(e("../features/settings/settings_view"),i),o(e("../system/localizations/localize"),i),cc._RF.pop()},{"../core-game/control":"control","../core-game/core_game":"core_game","../core-game/game_flow":"game_flow","../core-game/graphic_lib":"graphic_lib","../core-game/level_manager":"level_manager","../core-game/map_visual":"map_visual","../core-game/ui-gameplay/core_fx":"core_fx","../core-game/ui-gameplay/core_ui":"core_ui","../core-game/user_model":"user_model","../features/settings/settings_view":"settings_view","../services/audio/audio":"audio","../services/utils/utils_anim_fx":"utils_anim_fx","../services/utils/utils_common":"utils_common","../services/utils/utils_data":"utils_data","../services/utils/utils_ui":"utils_ui","../system/app_events":"app_events","../system/configurations/config_anim_fx":"config_anim_fx","../system/localizations/localize":"localize","../system/login":"login","../system/resources_manager":"resources_manager","./system_types":"system_types"}],anim_event_comp:[function(e,t,i){"use strict";cc._RF.push(t,"1bc47EZZkFF8rbV7uAlH4ia","anim_event_comp");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,s=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(n<3?o(s):n>3?o(t,i,s):o(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});const o=e("../system/all_modules"),{ccclass:n,property:s}=(o._,cc._decorator);let l=class extends cc.Component{playFXLevelUp(){o.planeUnlock.playFXLevelUp()}playFXCelebrate(){o.planeUnlock.playFXCelebrate()}playFxUFOSucksCoinsUp(){o.ufoView.playFxCoinCollect()}};l=a([n],l),i.default=l,cc._RF.pop()},{"../system/all_modules":"all_modules"}],app_events:[function(e,t,i){"use strict";cc._RF.push(t,"52c68VZ3tVDqZkl4VYVp838","app_events"),Object.defineProperty(i,"__esModule",{value:!0}),i.appEvents=void 0,e("../system/all_modules")._,i.appEvents={isAppHidden:!1,onAppShowCallbackArr:[],onAppHideCallbackArr:[],onAppShow(){this.isAppHidden=!1,this.onAppShowCallbackArr.map(e=>e())},addAppShowCallback(e){this.onAppShowCallbackArr.push(e)},onAppHide(){this.isAppHidden=!0,this.onAppHideCallbackArr.map(e=>e())},addAppHideCallback(e){this.onAppHideCallbackArr.push(e)}},cc._RF.pop()},{"../system/all_modules":"all_modules"}],audio:[function(e,t,i){"use strict";cc._RF.push(t,"272e5CwR4dAUYlvs84u9gnx","audio"),Object.defineProperty(i,"__esModule",{value:!0}),i.audio=void 0;const a=e("../../system/all_modules"),o=a._;i.audio={audioList:{},playingIdList:{},isSoundOff:!0,isMusicOff:!0,init(){a.login.addLoginDataFields("isMusicOff","isSoundOff"),a.login.addCallback(e=>{this.isMusicOff=e.isMusicOff,this.isSoundOff=e.isSoundOff,a.coreUI.updateSoundIcon()}),o.setTimeout(()=>this.loadAudioFiles(),1e3)},toggleSound(){this.isSoundOff=!this.isSoundOff,a.utilsData.save({isSoundOff:this.isSoundOff}),this.isSoundOff&&this.stopBgMusic()},loadAudioFiles(){cc.resources.loadDir("audios",cc.AudioClip,(e,t)=>{if(e)return o.log(e);for(let i of t)this.audioList[i.name]=i})},playSound(e,t=1){if(!this.isSoundOff&&this.audioList[e])try{this.playingIdList[e]=cc.audioEngine.play(this.audioList[e],!1,t)}catch(i){}},stopSound(e){this.playingIdList[e]&&cc.audioEngine.stopEffect(this.playingIdList[e])},playBgMusic(e=1){if(!this.isMusicOff&&!cc.audioEngine.isMusicPlaying())try{this.playingIdList.bg_music=cc.audioEngine.playMusic(this.audioList.bg_music,!0),cc.audioEngine.setMusicVolume(e)}catch(t){o.log("playMusic err ",t)}},stopBgMusic(){cc.audioEngine.isMusicPlaying()&&cc.audioEngine.stopMusic()},playSoundClickButton(){this.isSoundOff||this.playSound("button_click",1)}},cc._RF.pop()},{"../../system/all_modules":"all_modules"}],config_anim_fx:[function(e,t,i){"use strict";cc._RF.push(t,"c32cdMd/oBASIHmkQeG3U5M","config_anim_fx"),Object.defineProperty(i,"__esModule",{value:!0}),i.configAnimFx=void 0,e("../../system/all_modules")._,i.configAnimFx={defaultParticleFlyA2BConfigs:{numberOfNode:15,delayStartTime:.02,flyDuration:.6,randomBezierPointRange:{x:300,y:300}},questKeysFlyA2BConfigs:{numberOfNode:8,delayStartTime:.05,flyDuration:.6,randomBezierPointRange:{x:100,y:50}}},cc._RF.pop()},{"../../system/all_modules":"all_modules"}],control:[function(e,t,i){"use strict";cc._RF.push(t,"04bc3FI6gxPtqvezu3kr8M+","control"),Object.defineProperty(i,"__esModule",{value:!0}),i.control=void 0;const a=e("../system/all_modules"),o=a._;i.control={draggableRect:null,grandTileGroup:[],init(){cc.find("Canvas").on("touchend",e=>{o.log("------- Canvas on touchend >> event = ",e)}),this.setUpMultiTilesSelection(),this.setUpDraggableArea(),window.onresize=()=>o.setTimeout(()=>this.setUpDraggableArea(),200)},setUpMultiTilesSelection(){const e=cc.find("Canvas/play_area/selection_pad"),t=cc.find("Canvas/play_area/selection-highlight");let i;t.width=t.height=0,a.utilsUI.singleTouchSet(e,e=>{i=e,this.grandTileGroup=[],o.setGlobalPos(t,e)},e=>{const a=e.sub(i);t.width=o.abs(a.x),t.height=o.abs(a.y),t.scaleX=o.sign(a.x),t.scaleY=-o.sign(a.y)},()=>{const e=t.getBoundingBoxToWorld(),i=[];a.mapVisual.getTileArr().map(t=>{const n=o.getGlobalPosition(t);if(!new cc.Rect(n.x,n.y,t.width,t.height).intersects(e))return a.mapVisual.tileHighlightOff(t);o.addUniqueElemToArr(i,t.linkedGroup)}),i.map(e=>{e.map(e=>{a.mapVisual.tileHighlightOn(e),this.grandTileGroup.push(e)})}),t.width=t.height=0})},hightlightOffAllTiles(){this.grandTileGroup.map(e=>{e.linkedGroup.map(e=>{a.mapVisual.tileHighlightOff(e)})}),this.grandTileGroup=[]},setUpDraggableArea(){const e=cc.find("Canvas/play_area/draggable_area");e.width=cc.winSize.width-20,this.draggableRect=e.getBoundingBoxToWorld(),a.coreGame.rearrangeTilesToFitViewPort()},initTileControl(e){let t;a.utilsUI.singleTouchSet(e,i=>{a.gameFlow.isWin||(t=e.isHighlighted?this.grandTileGroup:e.linkedGroup).map(e=>{e.posDiff=o.getGlobalPosition(e).sub(i),a.mapVisual.tileUp(e);const t=i.add(e.posDiff);o.setGlobalPos(e,t),o.setGlobalPos(e.shadowNode,t)})},e=>{a.gameFlow.isWin||t.map(t=>{const i=e.add(t.posDiff);o.setGlobalPos(t,i),t.shadowNode.active&&o.setGlobalPos(t.shadowNode,i)})},()=>{if(a.gameFlow.isWin)return;t.map(e=>{a.mapVisual.tileDown(e),a.coreGame.onTileDrop(e)});const e=[];t.map(t=>{e.includes(t.linkedGroup)||(this.adjustTileGroupToFitDraggableArea(t),e.push(t.linkedGroup))}),this.hightlightOffAllTiles(),a.gameFlow.captureGameSnapShot()})},adjustTileGroupToFitDraggableArea(e){const t=this.draggableRect.center,i=e.linkedGroup;if(i.some(e=>{const i=e.gPos=o.getGlobalPosition(e).add(cc.v2(e.width/2,e.height/2));return e.posDiff=i.sub(t),e.distanceToCenter=e.posDiff.mag(),this.draggableRect.contains(i)}))return;const a=o.min(...i.map(e=>e.distanceToCenter)),n=i.find(e=>e.distanceToCenter==a),s=n.posDiff,l=s.clone();o.abs(s.x)>this.draggableRect.width/2&&(l.x=o.sign(s.x)*this.draggableRect.width/2),o.abs(s.y)>this.draggableRect.height/2&&(l.y=o.sign(s.y)*this.draggableRect.height/2);const r=t.add(l).sub(n.gPos);i.map(e=>{e.position=e.position.add(r)})}},cc._RF.pop()},{"../system/all_modules":"all_modules"}],core_fx:[function(e,t,i){"use strict";cc._RF.push(t,"96b33MmBstOOJJJhp7kz4/e","core_fx"),Object.defineProperty(i,"__esModule",{value:!0}),i.coreFX=void 0;const a=e("../../system/all_modules"),o=a._;i.coreFX={fxContainer:null,coinSampleNode:null,gemSampleNode:null,init(){this.coinSampleNode=cc.find("Canvas/sample_nodes/icon_coin"),this.gemSampleNode=cc.find("Canvas/sample_nodes/icon_gem"),this.fxContainer=cc.find("Canvas/fx_container"),this.fxContainer.zIndex=1e3},onWin(){cc.find("Canvas/fx_container/fx_confetti").active=!0,o.setTimeout(()=>this.clearWin(),6e3)},clearWin(){cc.find("Canvas/fx_container/fx_confetti").active=!1},animClaimCurrency(e,t,i,n,s,l,r=0){o.setTimeout(()=>{a.utilsAnimFx.particlesFlyFromA2B(e,t,i),a.utilsAnimFx.playIncreasingNumberLabel(n,s,l,15,.7,.4)},1e3*r)},animClaimCoin(e,t,i,n,s=0){this.animClaimCurrency(this.coinSampleNode,e,t,i,a.userModel.cash-n,n,s),o.setTimeout(()=>a.coreUI.updateAllCashLabels(),3e3+1e3*s),o.setTimeout(()=>a.audio.playSound("money_collect"),600+1e3*s)},animClaimGem(e,t,i,n,s=0){this.animClaimCurrency(this.gemSampleNode,e,t,i,a.userModel.gems-n,n,s),o.setTimeout(()=>a.coreUI.updateAllGemLabels(),3e3+1e3*s)},animateSellPlane(e){a.utilsAnimFx.playNodeAnim(e,"plane_sell"),a.utilsAnimFx.replayParticle(cc.find("fx_sell_smoke",e)),a.utilsAnimFx.replayParticle(cc.find("fx_coins_splash_sell",e))},xpFlyFromPlaneToBalance(e){let t=a.slotView.getXPNode();e.parent.addChild(t),t.setPosition(0,0),a.utilsAnimFx.replayParticle(t);const i=o.getGlobalPosDiff(e,cc.find("Canvas/HUD_top/player_level/icon_level"));let n=[cc.Vec2.ZERO,i.add(cc.v2(0,-300)),i];t.runAction(cc.sequence(cc.bezierTo(.75,n),cc.callFunc(()=>a.playgroundUI.updateXPMeter()),cc.delayTime(.5),cc.callFunc(()=>a.slotView.putXPNode(t))))},nodeAttractingParticles(e,t,i,n,s={flyTime:.6,partCount:20,startFadeInTime:.1,endFadeOutTime:.5,delayUnit:.03,offset:cc.Vec2.ZERO}){const{delayUnit:l,flyTime:r,partCount:c,startFadeInTime:u,endFadeOutTime:d,offset:_}=s,m=()=>{const e=a.utilsAnimFx.getRandomPointInRage({x:t.width/2,y:t.height/2});return cc.v2(t.x+e.x,t.y+e.y)};for(let a=0;a<c;a++)o.setTimeout(()=>{const t=o.copyNode(e,n||this.fxContainer);o.setTimeout(()=>t.removeFromParent(),1e3*r),o.setGlobalPos(t,m());const a=o.getMsPassedUTC(),s=o.getGlobalPosDiff(t,i).mag();t.opacity=0,cc.tween(t).to(u,{opacity:255}).delay(r-u-d).to(d,{opacity:0}).start();const l=o.setInterval(()=>{if(!t||!t.parent)return o.clearInterval(l);const e=(o.getMsPassedUTC()-a)/(1e3*r),n=o.abs(1-e)*s,c=o.getGlobalPosDiff(t,i),u=c.mul(n/c.mag()),d=o.getGlobalPosition(i).add(_).sub(u);o.setGlobalPos(t,d)},10)},l*a*1e3)}},cc._RF.pop()},{"../../system/all_modules":"all_modules"}],core_game:[function(e,t,i){"use strict";cc._RF.push(t,"d18c9K5CotOQ5HAybABZAy2","core_game"),Object.defineProperty(i,"__esModule",{value:!0}),i.coreGame=void 0;const a=e("../system/all_modules"),o=a._;i.coreGame={currentLevelInfo:null,currentAutoConnectRange:0,currentTimePassed:0,init(){cc.director.getCollisionManager().enabled=!0,this.startTimerInterval()},startTimerInterval(){setInterval(()=>{a.gameFlow.isWin||a.gameFlow.isPaused||(this.currentTimePassed++,a.coreUI.updateCurrentTimePassed(this.currentTimePassed))},1e3)},startGame(e,t){e=e||this.currentLevelInfo,this.currentLevelInfo=e,this.currentTimePassed=0,a.mapVisual.renderMap(e,()=>{this.currentAutoConnectRange=.25*a.mapVisual.currentTileSize,a.mapVisual.getTileArr().map(e=>{e.linkedGroup=[e],e.collidingTileArr=[]}),this.shuffleTiles(),a.coreUI.updateProgressBar(0),t&&t()})},shuffleTiles(){const e=a.mapVisual.gridContainer,t=cc.winSize.width/2,i=cc.winSize.height/2-90,n=1.5*a.mapVisual.currentTileSize,s=a.mapVisual.currentTileSize/2;e.children.map(a=>{const l=(o.random()>.5?1:-1)*e.width*.7*(.2+o.random()),r=(o.random()>.5?1:-1)*e.height*.7*(.2+o.random());a.x=-s+o.setInRange(l,t-n,-t+n)+e.width/2,a.y=-s+o.setInRange(r,i-n,-i+n)+e.height/2})},onTileDrop(e){e.collidingTileArr.map(t=>{e.linkedGroup.includes(t)||this.checkConnectTile(e,t)})},checkConnectTile(e,t){const i=e.cellPos,n=t.cellPos,s=i.y==n.y&&1==o.abs(i.x-n.x),l=i.x==n.x&&1==o.abs(i.y-n.y);if(!s&&!l)return;const r=s?"x":"y",c=s?"width":"height",u=i[r]>n[r]?e:t,d=u==e?t:e,_=u.connectPos=o.getGlobalPosition(u).add(cc.v2(u.width/2,u.height/2)),m=d.connectPos=o.getGlobalPosition(d).add(cc.v2(d.width/2,d.height/2));if(_[r]-=u[c]/2,m[r]+=d[c]/2,_.sub(m).mag()>this.currentAutoConnectRange)return;a.audio.playSound("tile-connect");const p=e.linkedGroup,h=t.linkedGroup,g=e.connectPos.sub(t.connectPos);h.map(e=>{p.push(e),e.linkedGroup=p,e.position=e.position.add(g),a.mapVisual.tileUp(e),a.mapVisual.tileDown(e)}),o.setTimeout(()=>{p.map(e=>p.map(t=>o.removeArrayItem(e.collidingTileArr,t)))}),p.length==a.mapVisual.currentTileCount&&setTimeout(()=>a.gameFlow.onWin()),this.updateGameCompletionProgress()},updateGameCompletionProgress(){const e=a.mapVisual.getTileArr(),t=e.filter(e=>e.linkedGroup.length>1).length;a.coreUI.updateProgressBar(t/e.length)},isTileSurroundedShadow(e){const t=e.cellPos;return[t.clone().add(cc.v2(1,0)),t.clone().add(cc.v2(0,-1)),t.clone().add(cc.v2(1,-1))].every(t=>e.linkedGroup.find(e=>t.equals(e.cellPos)))},rearrangeTilesToFitViewPort(){const e=[];a.mapVisual.getTileArr().map(t=>{o.addUniqueElemToArr(e,t.linkedGroup)}),e.map(e=>{const t=e.map(e=>o.getGlobalPosition(e).add(cc.v2(e.width/2,e.height/2))),i=o.max(...t.map(e=>e.x)),n=o.max(...t.map(e=>e.y)),s=o.min(...t.map(e=>e.x)),l=o.min(...t.map(e=>e.y)),r=cc.v2(0,0),c=a.control.draggableRect;i>c.xMax&&(r.x=c.xMax-i),n>c.yMax&&(r.y=c.yMax-n),s<c.xMin&&(r.x=c.xMin-s),l<c.yMin&&(r.y=c.yMin-l),e.map(e=>e.position=e.position.add(r))})}},cc._RF.pop()},{"../system/all_modules":"all_modules"}],core_ui:[function(e,t,i){"use strict";cc._RF.push(t,"a59c4C/ggZGrKeFH6MLR8QV","core_ui"),Object.defineProperty(i,"__esModule",{value:!0}),i.coreUI=void 0;const a=e("../../system/all_modules"),o=a._;i.coreUI={allLayoutPathArr:[],selectingGameParams:{gridCellWidth:3,gridCellHeight:2,inputPicture:""},bgColorArr:["#D3D3D3","#808080","#90EE90","#20B2AA","#E0FFFF","#4682B4","#FFEBCD","#C78585"],init(){cc.find("Canvas/nag_screen").zIndex=999,a.resources.addInitCallback(()=>{this.renderPictureScrollView(),this.renderPictureScrollViewWin()}),this.renderButtonGameSize(),this.renderButtonGame(),this.renderButtonPreview(),this.renderButtonBgColor(),a.utilsUI.makeButton("Canvas/header/timer_bar",()=>a.gameFlow.onPause()),a.utilsUI.makeButton("Canvas/layer_pause/btn_resume",()=>a.gameFlow.onResume()),a.utilsUI.makeButton("Canvas/layer_pause/btn_replay",()=>a.gameFlow.newGame()),a.utilsUI.makeButton("Canvas/layer_win/dialog/btn_replay",()=>a.gameFlow.newGame()),a.utilsUI.makeButton("Canvas/btn_full_screen",()=>{cc.screen.fullScreen()?cc.screen.exitFullScreen():cc.screen.requestFullScreen()}),o.setInterval(()=>{const e=cc.screen.fullScreen();cc.find("Canvas/btn_full_screen/btn_full_screen").active=!e,cc.find("Canvas/btn_full_screen/btn_exit_full_screen").active=e},200),a.utilsUI.makeButton("Canvas/btn_sound",()=>{a.audio.toggleSound(),this.updateSoundIcon()})},updateSoundIcon(){cc.find("Canvas/btn_sound/icon").getComponent(cc.Sprite).fillRange=a.audio.isSoundOff?.5:1},renderButtonGame(){const e=cc.find("Canvas/header/btn_new_game"),t=cc.find("Canvas/game_menu_container"),i=cc.find("Canvas/game_menu_container/bg/bg_block_input"),o=cc.find("Canvas/game_menu_container/btn_close");t.active=!1,a.utilsUI.makeButton(i,()=>t.active=!1,!0),a.utilsUI.makeButton(o,()=>t.active=!1,!0),a.utilsUI.makeButton(e,()=>{t.active=!0;const e=a.coreGame.currentLevelInfo;setTimeout(()=>this.scrollToPic(e.inputPicture,!0),100),this.setMapSizeSelectorLabel(e.gridCellWidth,e.gridCellHeight),this.selectingGameParams.gridCellWidth=e.gridCellWidth,this.selectingGameParams.gridCellHeight=e.gridCellHeight,this.selectingGameParams.inputPicture=e.inputPicture},!0),a.utilsUI.makeButton("Canvas/game_menu_container/btn_play",()=>{const e=a.coreGame.currentLevelInfo;Object.assign(e,this.selectingGameParams),a.gameFlow.checkPlayUniqueUrl(e.inputPicture,this.selectingGameParams.gridCellWidth,this.selectingGameParams.gridCellHeight)||(t.active=!1,setTimeout(()=>{a.gameFlow.newGame()}))})},renderButtonPreview(){const e=cc.find("Canvas/header/btn_preview"),t=cc.find("Canvas/header/btn_preview/drop_list_container/row/icon-full-preview"),i=cc.find("Canvas/header/btn_preview/drop_list_container/row/icon-opaque-preview"),o=cc.find("Canvas/header/btn_preview/drop_list_container/row/icon-opaque-preview/icon-done"),n=a.mapVisual.opaquePhotoNode,s=cc.find("Canvas/header/btn_preview/drop_list_container"),l=cc.find("Canvas/header/btn_preview/drop_list_container/bg/bg_block_input");a.utilsUI.makeButton(l,()=>s.active=!1,!0);const r=cc.find("Canvas/header/picture_preview"),c=cc.find("Canvas/header/picture_preview/bg_block_input");a.utilsUI.makeButton(c,()=>r.active=!1,!0),a.utilsUI.makeButton(e,()=>{a.gameFlow.isWin||(s.active=!0)},!0),a.utilsUI.makeButton(t,()=>{a.gameFlow.isWin||(r.active=!0,s.active=!1)},!0),a.utilsUI.makeButton(i,()=>{a.gameFlow.isWin||(n.active=!n.active,o.active=!o.active)},!0)},renderButtonBgColor(){const e=cc.find("Canvas/header/btn_bg_color"),t=cc.find("Canvas/bg_color_container"),i=cc.find("Canvas/bg_color_container/color-list"),n=cc.find("Canvas/bg_color_container/sample_row"),s=cc.find("Canvas/bg_color_container/bg/bg_block_input");a.utilsUI.makeButton(s,()=>t.active=!1,!0),a.utilsUI.makeButton(e,()=>{t.active=!0},!0),this.bgColorArr.map(e=>{const s=o.copyNode(n,i);s.color=cc.color(e),s.active=!0,a.utilsUI.makeButton(s,()=>{t.active=!1,this.setBgColor(e)},!0)}),a.utilsData.load(["bgColor"],e=>{this.setBgColor(e.bgColor||this.bgColorArr[0])})},setBgColor(e){const t=cc.color(e);cc.find("Canvas/header/btn_bg_color/bg-selected").color=t,cc.find("Canvas/bg/main_bg").color=t,a.utilsData.save({bgColor:e})},scrollToPic:null,renderPictureScrollView(){const e=cc.find("Canvas/game_menu_container/btn_select_picture"),t=cc.find("Canvas/game_menu_container/image_scroll_view").getComponent(cc.ScrollView),i=cc.find("Canvas/game_menu_container/image_scroll_view/view/content"),n=cc.find("Canvas/game_menu_container/image_scroll_view/view/sample_item"),s=cc.find("Canvas/game_menu_container/btn_select_picture/label_current_picture").getComponent(cc.Label),l=cc.find("Canvas/game_menu_container/pic_desc").getComponent(cc.Label),r=cc.find("Canvas/game_menu_container/btn_select_map_size/label_current_size").getComponent(cc.Label),c=e=>i.children.find(t=>t.picName==e),u=e=>{cc.find("focus-bg",e).active=!1,cc.find("photo",e).color=cc.color("#cccccc")},d=(e,t)=>{i.children.map(e=>u(e));const n=c(e);if(n&&(cc.find("photo",n).color=cc.color("#ffffff"),cc.find("focus-bg",n).active=!0,this.selectingGameParams.inputPicture=e,this.selectingGameParams.gridCellWidth=n.metaData.width,this.selectingGameParams.gridCellHeight=n.metaData.height,s.string=o.trimStr(n.metaData.name,21,"..."),l.string=n.metaData.description,r.string=n.metaData.width*n.metaData.height+"",t)){const e=a.coreGame.currentLevelInfo;r.string=e.gridCellWidth*e.gridCellHeight+""}};this.scrollToPic=(e,a)=>{if(!e)return;const o=i.children.findIndex(t=>t.picName==e);t.stopAutoScroll(),t.scrollToOffset(cc.v2(n.width*(o-.6),0),.1),d(e,a)},a.utilsUI.makeButton(e,()=>{const e=this.selectingGameParams.inputPicture;this.scrollToPic(e)},!0),a.resources.getInputPicrures().map(e=>{const t=o.copyNode(n,i);t.picName=e.name,t.metaData=e.metaData,t.active=!0,cc.find("photo",t).getComponent(cc.Sprite).spriteFrame=e.getComponent(cc.Sprite).spriteFrame,cc.find("label_pic_name",t).getComponent(cc.Label).string=o.trimStr(t.metaData.name,20,"..."),cc.find("label_pieces",t).getComponent(cc.Label).string=t.metaData.width*t.metaData.height+"",u(t),a.utilsUI.makeButton(t,()=>d(e.name),!0)})},scrollToPicInWin:null,renderPictureScrollViewWin(){const e=cc.find("Canvas/layer_win/dialog/image_scroll_view"),t=e.getComponent(cc.ScrollView),i=cc.find("Canvas/layer_win/dialog/image_scroll_view/view/content"),n=cc.find("Canvas/layer_win/dialog/image_scroll_view/view/sample_item"),s=cc.find("Canvas/layer_win/dialog/btn_toggle_scroll_view"),l=e=>i.children.find(t=>t.picName==e),r=e=>{cc.find("focus-bg",e).active=!1,cc.find("photo",e).color=cc.color("#cccccc")},c=e=>{i.children.map(e=>r(e));const t=l(e);t&&(cc.find("photo",t).color=cc.color("#ffffff"),cc.find("focus-bg",t).active=!0)};this.scrollToPicInWin=e=>{if(!e)return;const a=i.children.findIndex(t=>t.picName==e);t.stopAutoScroll(),t.scrollToOffset(cc.v2(n.width*(a-.6),0),.1),c(e)},a.resources.getInputPicrures().map(e=>{const t=o.copyNode(n,i);t.picName=e.name,t.metaData=e.metaData,t.active=!0,cc.find("photo",t).getComponent(cc.Sprite).spriteFrame=e.getComponent(cc.Sprite).spriteFrame,cc.find("label_pic_name",t).getComponent(cc.Label).string=o.trimStr(t.metaData.name,14,"..."),cc.find("label_pieces",t).getComponent(cc.Label).string=t.metaData.width*t.metaData.height+"",r(t),a.utilsUI.makeButton(t,()=>{if(a.gameFlow.checkPlayUniqueUrl(e.name,t.metaData.width,t.metaData.height))return;c(e.name);const i={inputPicture:e.name,gridCellWidth:t.metaData.width,gridCellHeight:t.metaData.height};a.gameFlow.newGame(i)},!0)});const u=s.getComponent(cc.Widget);a.utilsUI.makeButton(s,()=>{u.top+=(e.active?1:-1)*e.height,u.updateAlignment(),cc.find("icon_down",s).active=!e.active,cc.find("icon_up",s).active=e.active,e.active=!e.active},!0)},showWinScrollView(){const e=cc.find("Canvas/layer_win/dialog/image_scroll_view"),t=cc.find("Canvas/layer_win/dialog/btn_toggle_scroll_view");e.opacity=t.opacity=0,setTimeout(()=>{cc.tween(e).to(.5,{opacity:255}).start(),cc.tween(t).to(.5,{opacity:255}).start(),this.scrollToPicInWin(a.coreGame.currentLevelInfo.inputPicture)},1500)},setMapSizeSelectorLabel(e,t){cc.find("Canvas/game_menu_container/btn_select_map_size/label_current_size").getComponent(cc.Label).string=`${e*t}`},renderButtonGameSize(){const e=cc.find("Canvas/game_menu_container/btn_select_map_size"),t=cc.find("Canvas/game_menu_container/btn_select_map_size/drop_list_container"),i=cc.find("Canvas/game_menu_container/btn_select_map_size/drop_list_container/sample_row"),n=cc.find("Canvas/game_menu_container/btn_select_map_size/drop_list_container/bg/bg_block_input");a.utilsUI.makeButton(e,()=>t.active=!0,!0),a.utilsUI.makeButton(n,()=>t.active=!1,!0),a.gameFlow.availableGameSizeArr.map(e=>{const n=e.split("x"),s=parseInt(n[0]),l=parseInt(n[1]),r=o.copyNode(i,t);cc.find("label",r).getComponent(cc.Label).string=s*l+"",r.active=!0,a.utilsUI.makeButton(r,()=>{t.active=!1,this.setMapSizeSelectorLabel(s,l),this.selectingGameParams.gridCellWidth=s,this.selectingGameParams.gridCellHeight=l},!0)})},updateProgressBar(e){const t=cc.find("Canvas/header/picture_progress/progress"),i=cc.find("Canvas/header/picture_progress/label");t.opacity=255,t.orgW=t.orgW||t.width,t.width=t.orgW*e,i.getComponent(cc.Label).string=o.floor(100*e)+"%"},updateBestTime(e){cc.find("Canvas/header/best_timer_bar/label_timer").getComponent(cc.Label).string=o.formatTime(e)},updateCurrentTimePassed(e){const t=cc.find("Canvas/header/timer_bar/label_timer");a.utilsUI.fillLabel(t,o.formatTime(e))},showNagScreen(e){cc.find("Canvas/nag_screen").active=!0,e&&o.setTimeout(()=>this.hideNagScreen(),1e3*e)},hideNagScreen(){cc.find("Canvas/nag_screen").active=!1},showLoading(e){cc.find("Canvas/layer_loading").active=!0,e&&o.setTimeout(()=>this.hideLoading(),1e3*e)},hideLoading(){cc.find("Canvas/layer_loading").active=!1},allLayoutsOffCallbackArr:[],isRunningLayoutOffCheck:null,isAllLayoutsOff(){return this.allLayoutPathArr.every(e=>!cc.find(e)||!cc.find(e).active)},addCallbackAllLayoutsOff(e){this.allLayoutsOffCallbackArr.push(e),this.isRunningLayoutOffCheck||(this.isRunningLayoutOffCheck=o.waitToRun(()=>{this.allLayoutsOffCallbackArr.map(e=>{o.removeArrayItem(this.allLayoutsOffCallbackArr,e),e(),this.isRunningLayoutOffCheck=null})},"isAllLayoutsOff()",this,.3))},pendingPopupArr:[],isShowingPopup:!1,popupNameArr:[],showLayout(e,t,i){let a=cc.find(`Canvas/${e}`);return a.active=!1,this.popupNameArr.includes(e)&&this.isShowingPopup?this.pendingPopupArr.push({layoutNode:a,onShowCallback:t}):this.doShowLayout(a,t,i),a},doShowLayout(e,t,i){this.isShowingPopup=this.popupNameArr.includes(e.name),e.active=!0,a.utilsAnimFx.playNodeAnim(e,i,1,!0),t&&t(e)},hideLayout(e){if(o.isString(e)&&(e=cc.find(`Canvas/${e}`)),e.active=!1,!this.popupNameArr.includes(e.name))return;this.isShowingPopup=!1;const t=this.pendingPopupArr.shift();t&&this.doShowLayout(t.layoutNode,t.onShowCallback)}},cc._RF.pop()},{"../../system/all_modules":"all_modules"}],en_US:[function(e,t){"use strict";cc._RF.push(t,"dd1f2WqfNRLr4YxR6nNnY4L","en_US");const i=e("../../../system/all_modules");i._,t.exports={common_label_button_close:"Fermer",common_label_share:"Partager",common_label_plane_detail_speed:"Vitesse",common_label_earnings:"Gains",common_label_button_collect:"R\xe9cup\xe9rer",common_label_button_free:"Gratuit",label_home_button_quest:"Qu\xeate",label_home_recycle_bin_sell:"Vendre",label_home_button_leaderboard:"Classement",label_home_button_buy_using_coin:"pi\xe8ces de monnaie",label_home_earning_per_second:e=>`${e}/sec.`,label_settings_header:"Param\xe8tres",label_settings_sound:"Son",label_settings_music:"Musique",label_settings_text_on:"Activ\xe9(e)",label_settings_text_off:"D\xe9sactiv\xe9(e)",label_settings_text_language:"Langue",label_quest_layout_header:"D\xe9fi",label_quest_layout_tab_quest:"Qu\xeate",label_quest_layout_tab_achievement:"Succ\xe8s",label_quest_layout_reset_intro:"Les qu\xeates se r\xe9initialisent dans\xa0:",label_quest_intro_login:"Connectez-vous aujourd'hui",label_quest_intro_merge:e=>`Fusionner ${e}\xa0avions`,label_quest_intro_watch_video:e=>`Regarder ${e}\xa0vid\xe9os`,label_quest_intro_invite_friends:e=>`Inviter ${e}\xa0fois des amis`,label_quest_intro_speed_up:e=>`Acc\xe9l\xe9rer ${e}\xa0fois`,label_quest_txt_rewards:"R\xe9compenses",label_achievement_intro_merge:({mergeTime:e,extraRequirements:{planeLevel:t}})=>`Fusionnez pour cr\xe9er ${e}\xa0avions de niveau\xa0${t}`,label_ufo_reward_header:"BONUS D'OVNI\xa0!",label_ufo_reward_time_intro:e=>`Dans\xa0${e}\xa0secondes`,label_unlock_feature_intro_quests:"Fonctionnalit\xe9 de qu\xeates d\xe9verrouill\xe9e\xa0!",label_unlock_feature_intro_leaderboard:"Fonctionnalit\xe9 de tableau des scores d\xe9verrouill\xe9e\xa0!",label_daily_bonus_header:"Bonus de retour quotidien",label_daily_bonus_reset_note:"R\xe9initialisation quotidienne \xe0 11\xa0h\xa059 (Heure du Pacifique)",label_daily_bonus_day_name:e=>`Jour\xa0${e}`,label_daily_bonus_x2btn_up_1_level:"+1\xa0niveau\nd'avion",label_daily_bonus_x2btn_double:"Doubles\nr\xe9compenses",label_leaderboard_header:"Tableau des scores",label_leaderboard_top_50:e=>`TOP\xa0${e}`,label_leaderboard_tab_global:"Global",label_leaderboard_tab_friends:"Amis",label_leaderboard_no_friend:"Aucun ami trouv\xe9",label_leadeboard_button_invite:"Inviter des amis",label_speedup_header:"Plus vite\xa0!",label_speedup_time_intro:"Vitesse x2",label_speedup_intro_add_time:e=>`Ajouter encore ${e}\xa0secondes`,label_levelup_header:"Niveau sup\xe9rieur\xa0!",label_levelup_unlocked_intro:"Vous avez d\xe9verrouill\xe9",label_planeunlock_header:()=>"D\xe9verrouill\xe9".toUpperCase(),label_planeunlock_next_plane:"Suivant",label_store_header:()=>"Magasin",label_store_plane_btn_buy_locked:e=>`D\xe9verrouiller l'avion\xa0${e}`,label_offline_rewards_header:"R\xe9compenses hors-ligne",label_offline_rewards_profits_x2:"Profits x2",label_offline_rewards_profits_x3:"Profits x3",label_offline_rewards_time_lapsed:e=>e!=i.configOfflineEarnings.maxOfflineTimeText?`Les gains hors-ligne ont atteint le maximum de ${e}\xa0heures`:`Les gains hors ligne ont atteint le maximum de ${i.configOfflineEarnings.maxOfflineTimeInHours} heures`,label_tutorial_tap_to_continue:"Touchez pour continuer",label_tutorial_guide:e=>({welcome_msg:"Bonjour capitaine\xa0! Commen\xe7ons un nouvel empire a\xe9rien d\xe8s aujourd'hui\xa0!",tutorial_end:"Bon travail\xa0! Gagnez des pi\xe8ces de monnaie pour d\xe9bloquer les avions des niveaux sup\xe9rieurs, capitaine\xa0!"})[e],label_dialog_small_message:e=>({no_cash:"Argent comptant insuffisant",no_gem:"Gemmes insuffisantes",no_spot:"Plus aucun espace de stationnement",no_track:"Plus de place sur l'avion",invite_sent:"Une invitation a \xe9t\xe9\nenvoy\xe9e \xe0 vos amis"})[e],label_dialog_option_message:e=>({intro_subscribe_bot:"Abonnez-vous pour recevoir un cadeau de d\xe9marrage dans la bo\xeete \xe0 messages\xa0!",intro_create_shortcut:"Cr\xe9ez un raccourci pour revenir jouer plus facilement\xa0!"})[e],label_dialog_option_btn_confirm:"D'accord\xa0!",label_dialog_option_btn_cancel:"peut-\xeatre plus tard",fb_invite_message_text:e=>`${e} veut vous affronter lors d'une course\xa0!`,fb_invite_message_cta:"JOUER",fb_invite_message_image_txt_challenge:"D\xe9fi",fb_share_levelup_image_text:({playerName:e,level:t})=>`${e} a atteint le niv.\xa0${t}\xa0!`,fb_share_unlock_plane_image_text:({playerName:e,planeLevel:t})=>`${e} a d\xe9verrouill\xe9 l'avion\xa0${t}\xa0!`,fb_share_unlock_plane_image_text_top:"Avion d\xe9verrouill\xe9\xa0!"},cc._RF.pop()},{"../../../system/all_modules":"all_modules"}],es_ES:[function(e,t){"use strict";cc._RF.push(t,"25a77jAOblFdowbqdhP1tct","es_ES");const i=e("../../../system/all_modules");i._,t.exports={common_label_button_close:"Cerrar",common_label_share:"Compartir",common_label_plane_detail_speed:"Velocidad",common_label_earnings:"Ganancias",common_label_button_collect:"Recoger",common_label_button_free:"Gratis",label_home_button_quest:"Misiones",label_home_recycle_bin_sell:"Vender",label_home_button_leaderboard:"Ranking",label_home_button_buy_using_coin:"monedas",label_home_earning_per_second:e=>`${e}/s`,label_settings_header:"Ajustes",label_settings_sound:"Sonido",label_settings_music:"M\xfasica",label_settings_text_on:"S\xed",label_settings_text_off:"No",label_settings_text_language:"Idioma",label_quest_layout_header:"Desaf\xedo",label_quest_layout_tab_quest:"Misi\xf3n",label_quest_layout_tab_achievement:"Logro",label_quest_layout_reset_intro:"La misi\xf3n se reinicia en:",label_quest_intro_login:"Con\xe9ctate hoy",label_quest_intro_merge:e=>`Fusiona ${e} aviones`,label_quest_intro_watch_video:e=>`Mira ${e} v\xeddeos`,label_quest_intro_invite_friends:e=>`Invita amigos ${e} veces`,label_quest_intro_speed_up:e=>`Acelera ${e} veces`,label_quest_txt_rewards:"Recompensas",label_achievement_intro_merge:({mergeTime:e,extraRequirements:{planeLevel:t}})=>`Fusiona para crear ${e} aviones de nivel ${t}`,label_ufo_reward_header:"\xa1BONIFICACI\xd3N DE OVNI!",label_ufo_reward_time_intro:e=>`En ${e} segundos`,label_unlock_feature_intro_quests:"\xa1Misiones destacadas desbloqueadas!",label_unlock_feature_intro_leaderboard:"\xa1Marcador destacado desbloqueado!",label_daily_bonus_header:"Bonificaci\xf3n de devoluci\xf3n diaria",label_daily_bonus_reset_note:"Se reinicia a las 11:59 cada d\xeda",label_daily_bonus_day_name:e=>`D\xeda ${e}`,label_daily_bonus_x2btn_up_1_level:"+1 nivel\nde avi\xf3n",label_daily_bonus_x2btn_double:"Recompensas\ndobles",label_leaderboard_header:"Marcador",label_leaderboard_top_50:e=>`${e} MEJORES`,label_leaderboard_tab_global:"Global",label_leaderboard_tab_friends:"Amigos",label_leaderboard_no_friend:"No se ha encontrado amigo",label_leadeboard_button_invite:"Invitar amigos",label_speedup_header:"\xa1Acelera!",label_speedup_time_intro:"Velocidad x2",label_speedup_intro_add_time:e=>`A\xf1ade otros ${e} segundos!`,label_levelup_header:"\xa1Sube de nivel!",label_levelup_unlocked_intro:"Has desbloqueado",label_planeunlock_header:()=>"Desbloquear".toUpperCase(),label_planeunlock_next_plane:"Siguiente",label_store_header:()=>"Tienda",label_store_plane_btn_buy_locked:e=>`Desbloquear avi\xf3n ${e}`,label_offline_rewards_header:"Recompensas offline",label_offline_rewards_profits_x2:"Beneficios x2",label_offline_rewards_profits_x3:"Beneficios x3",label_offline_rewards_time_lapsed:e=>e!=i.configOfflineEarnings.maxOfflineTimeText?`Las ganancias online han alcanzado el m\xe1ximo de ${e} horas`:`Los ingresos sin conexi\xf3n alcanzaron el m\xe1ximo de ${i.configOfflineEarnings.maxOfflineTimeInHours} horas`,label_tutorial_tap_to_continue:"Toca para continuar",label_tutorial_guide:e=>({welcome_msg:"\xa1Bienvenido, Capit\xe1n! \xa1Comencemos un nuevo imperio de l\xedneas a\xe9reas hoy!",tutorial_end:"\xa1Buen trabajo! \xa1Gana monedas para desbloquear los aviones de nivel alto, capit\xe1n!"})[e],label_dialog_small_message:e=>({no_cash:"No hay suficiente dinero",no_gem:"Gemas insuficientes",no_spot:"No hay m\xe1s sitios de parking",no_track:"No hay espacio en la aerol\xednea",invite_sent:"Se ha enviado una\ninvitaci\xf3n a tus amigos"})[e],label_dialog_option_message:e=>({intro_subscribe_bot:"\xa1Suscr\xedbete para recibir un regalo de inicio en el buz\xf3n!",intro_create_shortcut:"\xa1Crea un atajo para volver a jugar m\xe1s f\xe1cil!"})[e],label_dialog_option_btn_confirm:"\xa1Claro!",label_dialog_option_btn_cancel:"tal vez m\xe1s tarde",fb_invite_message_text:e=>`\xa1${e} te desaf\xeda a una carrera!`,fb_invite_message_cta:"JUGAR",fb_invite_message_image_txt_challenge:"Desafiar",fb_share_levelup_image_text:({playerName:e,level:t})=>`\xa1${e} ha alcanzado el nv. ${t}!`,fb_share_unlock_plane_image_text:({playerName:e,planeLevel:t})=>`\xa1${e} ha desbloqueado el avi\xf3n ${t}!`,fb_share_unlock_plane_image_text_top:"\xa1Avi\xf3n desbloqueado!"},cc._RF.pop()},{"../../../system/all_modules":"all_modules"}],free_button_comp:[function(e,t,i){"use strict";cc._RF.push(t,"64398ru1J5Fi4AdS3n3ocH+","free_button_comp");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,s=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(n<3?o(s):n>3?o(t,i,s):o(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0}),e("../../system/all_modules")._;const{ccclass:o,property:n}=cc._decorator;let s=class extends cc.Component{freeHandler(e){e.target.freeButtonHandlerFunc&&e.target.freeButtonHandlerFunc(e.target)}};s=a([o],s),i.default=s,cc._RF.pop()},{"../../system/all_modules":"all_modules"}],game_flow:[function(e,t,i){"use strict";cc._RF.push(t,"05146yXT4ZKObC2KzM1/VhA","game_flow"),Object.defineProperty(i,"__esModule",{value:!0}),i.gameFlow=void 0;const a=e("../system/all_modules"),o=a._;i.gameFlow={initUniqueUrlParam:"",availableGameSizeArr:["3x4","6x4","9x6","12x8","15x10","18x12","21x14"],isWin:!1,isPaused:!1,bestTimeSaved:{},isLocalhost:()=>!1,parseUniqueUrl(){const e=window.location.toString().replace(/\?.*$/,"").replace(/\/$/,""),t=a.levelManager.getLevelInfoByUniqueUrl(e);if(!t)return;const i=new URL(location.href).searchParams.get("size");if(i){const[e,a]=i.split("x").map(Number);return Object.assign(Object.assign({},t),{width:e,height:a})}return t},checkPlayUniqueUrl(e,t,i){if(this.isLocalhost())return;const o=a.levelManager.inputPictureToUniqueUrl(e);if(!o)return;const n=`?size=${t}x${i}`;let s=o.replace(/\?size=.*$/,"")+n;window.isUsingHistoryPushState&&history.pushState?window.history.pushState({path:s},"",s):location.href=s},init(){a.resources.addInitCallback(()=>{a.utilsData.load(["bestTimeSaved","lastGameTimePassed","lastGameStates"],e=>{this.bestTimeSaved=e.bestTimeSaved||{};const t=a.resources.getPictureNameArr(),i=this.parseUniqueUrl();if(i){const e={inputPicture:a.levelManager.picInfoToPicName(i.id),gridCellWidth:i.width,gridCellHeight:i.height};this.newGame(e)}else if(e.lastGameStates&&e.lastGameStates.levelInfo&&t.includes(e.lastGameStates.levelInfo.inputPicture))this.restoreSavedGame(e.lastGameStates,e.lastGameTimePassed||0);else{const e={inputPicture:t[0],gridCellWidth:3,gridCellHeight:4};this.newGame(e)}this.initGameTimePassedSaving()})})},newGame(e,t){a.mapVisual.gridContainer.opacity=1,a.coreUI.showLoading(),this.isWin=!1,this.isPaused=!1,e=e||a.coreGame.currentLevelInfo,a.coreFX.clearWin(),a.coreGame.startGame(e,()=>{const i=this.bestTimeSaved[this.getGameParamsEntryName(e)];a.coreUI.updateBestTime(i||0),a.coreUI.hideLayout("layer_win"),a.mapVisual.finalPhotoNode.active=!1;let o=0;t?o=t()||0:this.captureGameSnapShot(),setTimeout(()=>{a.coreUI.hideLoading(),this.onResume()},1e3*o)})},onWin(){a.coreUI.showWinScrollView(),a.coreUI.showLayout("layer_win"),this.isWin=!0,this.checkSaveBestTime(),a.audio.playSound("win");const e=a.mapVisual.bottomLeftTile,t=e.position.mul(-1);a.coreUI.showNagScreen(),e.linkedGroup.map(e=>{cc.tween(e).by(.5,{position:t}).call(()=>{a.mapVisual.finalPhotoNode.active=!0,a.coreFX.onWin(),a.coreUI.hideNagScreen()}).start()}),this.captureGameSnapShot(!0)},checkSaveBestTime(){const e=a.coreGame.currentLevelInfo,t=this.getGameParamsEntryName(e),i=this.bestTimeSaved[t]||99999,o=a.coreGame.currentTimePassed;o<i&&(this.bestTimeSaved[t]=o,a.utilsData.save({bestTimeSaved:this.bestTimeSaved}),a.coreUI.updateBestTime(o))},getGameParamsEntryName:e=>e.gridCellWidth+"x"+e.gridCellHeight+"_"+e.inputPicture,onPause(){this.isWin||(this.isPaused=!0,a.mapVisual.gridContainer.opacity=0,a.coreUI.showLayout("layer_pause"),a.mapVisual.opaquePhotoNode.scale=0)},onResume(){this.isPaused=!1,a.mapVisual.gridContainer.opacity=255,a.coreUI.hideLayout("layer_pause"),a.mapVisual.opaquePhotoNode.scale=1},currentGameState:{},initGameTimePassedSaving(){o.setInterval(()=>{const e=this.isWin?0:a.coreGame.currentTimePassed;a.utilsData.save({lastGameTimePassed:e})},1e3)},captureGameSnapShot(e){if(e)return a.utilsData.save({lastGameStates:null});let t=[];const i=a.mapVisual.getTileArr();i.map(e=>{o.addUniqueElemToArr(t,e.linkedGroup)}),t=t.map(e=>e.map(e=>e.cellPos.x+"_"+e.cellPos.y));const n={};i.map(e=>{const t=e.cellPos.x+"_"+e.cellPos.y;n[t]={x:e.x.toFixed(3),y:e.y.toFixed(3)}}),this.currentGameState={levelInfo:a.coreGame.currentLevelInfo,linkedGroupArr:t,tilePosList:n},a.utilsData.save({lastGameStates:this.currentGameState})},restoreSavedGame(e,t){const{levelInfo:i,linkedGroupArr:o,tilePosList:n}=e;i&&o&&n&&this.newGame(i,()=>(setTimeout(()=>{const e=a.mapVisual.getTileArr();a.coreGame.currentTimePassed=t,e.map(e=>{const t=e.cellPos.x+"_"+e.cellPos.y;o.some(i=>{const a=i.indexOf(t);return-1!=a&&(e.linkedGroup=i,i[a]=e,!0)})}),a.coreGame.updateGameCompletionProgress(),o.map(e=>{e.map(e=>{const t=e.cellPos.x+"_"+e.cellPos.y;e.setPosition(n[t].x,n[t].y)}),a.control.adjustTileGroupToFitDraggableArea(e[0])})},100),.2))}},cc._RF.pop()},{"../system/all_modules":"all_modules"}],graphic_lib:[function(e,t,i){"use strict";cc._RF.push(t,"36d2c9WBElAd7dhY4oxoUwP","graphic_lib"),Object.defineProperty(i,"__esModule",{value:!0}),i.graphicLib=void 0;const a=e("../system/all_modules")._;i.graphicLib={webGLObj:null,isWebGLBusy:!1,webGLQueue:[],init(){const e=document.createElement("canvas");this.webGLObj=e.getContext("webgl")},spriteFrameToPixelArr(e,t,i=!1){if(this.isWebGLBusy)return this.webGLQueue.push(()=>this.spriteFrameToPixelArr(e,t,!0));this.isWebGLBusy=!0;const o=()=>{this.isWebGLBusy=!1,i&&this.webGLQueue.shift(),this.webGLQueue.length&&setTimeout(()=>this.webGLQueue[0]&&this.webGLQueue[0]())};if(e.getTexture().nativeUrl||a.log(`nativeUrl = null - spriteFrame=${e.name||e._name} `),!e.getTexture().nativeUrl)return o();const n=new Image,s=this.webGLObj;n.onload=function(){s.clear(s.DEPTH_BUFFER_BIT);var e=s.createTexture();const i=this.width,a=this.height;s.bindTexture(s.TEXTURE_2D,e),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!0),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,this),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR);var n=s.createFramebuffer();s.bindFramebuffer(s.FRAMEBUFFER,n),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,e,0);var l=new Uint8Array(i*a*4);s.readPixels(0,0,i,a,s.RGBA,s.UNSIGNED_BYTE,l),s.deleteFramebuffer(n),t&&t(l,i,a),o()},n.src=e.getTexture().nativeUrl},cropImageDataFromUInt8Arr(e,t,i,o,n,s){const l=e.length/4/t;[i,o,n,s]=[a.round(i),a.round(o),a.round(n),a.round(s)];const r=new Uint8Array(n*s*4);for(let a=0;a<s;a++)for(let s=0;s<n;s++){const c=a+o,u=s+i,d=c>=0&&c<l&&u>=0&&u<t;for(let i=0;i<4;i++)r[4*(a*n+s)+i]=d?e[4*(c*t+u)+i]:0}return r},pixelArrToSpriteFrameGrid(e,t,i,o,n,s,l,r){const c=[],u=t/o,d=i/n;for(let _=0;_<n;_++){c[_]=[];for(let i=0;i<o;i++){const o={x:i*u+s,y:_*d+l,w:u-2*s,h:d-2*l},n=this.cropImageDataFromUInt8Arr(e,t,o.x,o.y,o.w,o.h),r=new cc.Texture2D;r.setFlipY(!0),r.setPremultiplyAlpha(!0),r.initWithData(n,cc.Texture2D.PixelFormat.RGBA8888,a.round(o.w),a.round(o.h)),c[_][i]=new cc.SpriteFrame(r)}}return c},spriteFrameToSpriteFrameGrid(e,t,i,o,n,s,l){const r=e.getOriginalSize();this.spriteFrameToPixelArr(e,e=>{const[c,u]=[t.width,t.height];let d=e;r.width!=t.width&&(d=this.resizePictureByPixelArr(e,r,t));const _=[],m=c/i,p=u/o;for(let t=0;t<o;t++){_[t]=[];for(let e=0;e<i;e++){const i={x:e*m+n,y:t*p+s,w:m-2*n,h:p-2*s},o=this.cropImageDataFromUInt8Arr(d,c,i.x,i.y,i.w,i.h),l=new cc.Texture2D;l.setFlipY(!0),l.setPremultiplyAlpha(!0),l.initWithData(o,cc.Texture2D.PixelFormat.RGBA8888,a.round(i.w),a.round(i.h)),_[t][e]=new cc.SpriteFrame(l)}}l&&l(_)})},pixelArrToSpriteFrame(e,t,i){const a=new cc.Texture2D;return a.setFlipY(!0),a.setPremultiplyAlpha(!0),a.initWithData(e,cc.Texture2D.PixelFormat.RGBA8888,t,i),new cc.SpriteFrame(a)},resizePictureByPixelArr(e,t,i){a.log(`fitSize = ${i.width}/${i.height} .... orgSize=${t.width}/${t.height}`);const o=i.width/t.width,n=new Uint8Array(i.width*i.height*4);for(let s=0;s<i.height;s++)for(let l=0;l<i.width;l++){const r=a.floor(l/o),c=a.floor(s/o),u=4*(i.width*s+l),d=4*(t.width*c+r);[0,1,2,3].map(t=>{n[u+t]=e[d+t]})}return n}},cc._RF.pop()},{"../system/all_modules":"all_modules"}],level_manager:[function(e,t,i){"use strict";cc._RF.push(t,"f698aycMHlEgYRVAw1Z3skG","level_manager"),Object.defineProperty(i,"__esModule",{value:!0}),i.levelManager=void 0;const a=e("../system/all_modules");a._,i.levelManager={puzzleInfoArr:[],init(){a.coreUI.showLoading();let e=window._EXTERNAL_DATA;e||(e=cc.find("Canvas/sprite_frames_store/input_pictures").children.map((e,t)=>({id:t,name:e.name,imageUrl:e.getComponent(cc.Sprite).spriteFrame.getTexture().nativeUrl,url:"",description:`Desc ${e.name}`,width:6,height:4}))),this.puzzleInfoArr=e,a.resources.initData(e)},getLevelInfoByUniqueUrl(e){return this.puzzleInfoArr.find(t=>t.url==e||t.url==e+"/")},picInfoToPicName:e=>"puzzle_"+e,inputPictureToUniqueUrl(e){const t=this.puzzleInfoArr.find(t=>t.id+""==e.replace("puzzle_",""));return t?t.url:""}},cc._RF.pop()},{"../system/all_modules":"all_modules"}],localize:[function(e,t,i){"use strict";cc._RF.push(t,"759c03/vpNFWJHCyl2aAMRO","localize"),Object.defineProperty(i,"__esModule",{value:!0}),i.localize=void 0;const a=e("../../system/all_modules"),o=a._,n={en:"en_US",pt_BR:"pt_PT","pt-PT":"pt_PT",fr_CA:"fr_FR",ar:"ar_AR",de:"de_DE",es:"es_ES",es_LA:"es_ES",es_MX:"es_ES","zh-CN":"zh_CN","zh-TW":"zh_TW",fr:"fr_FR",id:"id_ID",ru:"ru_RU",th:"th_TH",tr:"tr_TR",vi:"vi_VN"},s={};i.localize={supportedLanguageArr:[{code:"en_US",name:"English"},{code:"fr_FR",name:"Fran\xe7ais"}],currentLanguageCode:"en_US",defaultLanguageObject:e("en_US"),currentLanguageObject:null,languageChangeCallbackArr:[],initCallbackArr:[],isInitialized:!1,init(){this.currentLanguageObject=this.defaultLanguageObject,a.login.addLoginDataFields("userLanguageCode"),a.login.addCallback(e=>{this.isInitialized=!0;const t=window.FBInstant?FBInstant.getLocale():null;this.onLanguageChanges(e.userLanguageCode||t,!0)})},onLanguageChanges(t,i=!1){if(t=n[t]||t,i||t&&this.currentLanguageCode!=t){try{t=t||this.currentLanguageCode,this.currentLanguageObject=e(t),this.currentLanguageCode=t,a.utilsData.save({userLanguageCode:this.currentLanguageCode})}catch(o){}i?this.initCallbackArr.map(e=>e()):this.languageChangeCallbackArr.map(e=>e(t))}},subscribeTranslate(e){const t=o.getNodePath(e),i=()=>this.translateContainer(e);s[t]||(this.initCallbackArr.push(i),this.languageChangeCallbackArr.push(i)),this.isInitialized&&i()},addInitCallback(e){if(this.isInitialized)return e();this.initCallbackArr.push(e)},translateContainer(e){e&&e.getComponentsInChildren(cc.Label).map(e=>this.translateSingleLabel(e.node))},translateSingleLabel(e,t){const i=this.currentLanguageObject[e.name]||this.defaultLanguageObject[e.name];if(!i)return;e.localizeData=t||e.localizeData;let o=i;"function"==typeof i&&(o=i(e.localizeData)),a.utilsUI.fillLabel(e,o)},translate(e,t){const i=this.currentLanguageObject[e]||this.defaultLanguageObject[e];if(!i)return e;let a=i;return"function"==typeof i&&(a=i(t)),a}},cc._RF.pop()},{"../../system/all_modules":"all_modules",en_US:"en_US"}],login:[function(e,t,i){"use strict";cc._RF.push(t,"2a5deR8LDtAEp7UiLY2ZoZe","login"),Object.defineProperty(i,"__esModule",{value:!0}),i.login=void 0;const a=e("./all_modules"),o=a._,n=["IsOldUser"],s=[];i.login={loginData:null,entryPointData:null,init(){this.entryPointData=a.utilsData.getEntryPointData(),setTimeout(()=>this.loadUserData())},loadUserData(){a.utilsData.load(n,e=>{this.loginData=e,e.isNewUser=!e.IsOldUser,a.utilsData.save({IsOldUser:!0}),s.map(t=>t(e))})},addLoginDataFields(...e){e.map(e=>o.addUniqueElemToArr(n,e))},addCallback(e){this.loginData?e(this.loginData):s.push(e)}},cc._RF.pop()},{"./all_modules":"all_modules"}],map_visual:[function(e,t,i){"use strict";cc._RF.push(t,"eb4b9bQas1GAohj4mQd2i4Q","map_visual"),Object.defineProperty(i,"__esModule",{value:!0}),i.mapVisual=void 0;const a=e("../system/all_modules"),o=a._;i.mapVisual={availablePictureSize:{width:0,height:0},currentPictureFitSize:{width:0,height:0},gridContainer:null,bottomLeftTile:null,previewPhotoNode:null,opaquePhotoNode:null,finalPhotoNode:null,currentTileSize:0,currentTileCount:0,getTileArr(){return this.gridContainer=cc.find("Canvas/play_area/grid"),this.gridContainer.children.filter(e=>"tile_cell"==e.name)},init(){this.gridContainer=cc.find("Canvas/play_area/grid"),this.previewPhotoNode=cc.find("Canvas/header/picture_preview/photo"),this.opaquePhotoNode=cc.find("Canvas/play_area/opaque_photo"),this.finalPhotoNode=cc.find("Canvas/play_area/final_photo"),this.availablePictureSize=this.getFinalPictureSize()},getFinalPictureSize(){const e=cc.find("Canvas/available_pic_size");return{width:e.width,height:e.height}},getPictureFitSize(e){const{width:t,height:i}=e,a=this.availablePictureSize.width/t,n=this.availablePictureSize.height/i,s=o.min(a,n,1);return{width:o.floor(t*s),height:o.floor(i*s)}},renderMap(e,t){const{inputPicture:i,gridCellWidth:n,gridCellHeight:s}=e,l=a.resources.getInputPictureSpriteByName(i),r=l.getOriginalSize(),c=this.currentPictureFitSize=this.getPictureFitSize(r);Object.assign(r,c),o.log(` pictureSprite.getOriginalSize() = ${l.getOriginalSize().width} / ${l.getOriginalSize().height}\n                pictureTextureSize= ${r.width} / ${r.height}`);const u=r.width,d=r.height,_={w:u/n,h:d/s},m=cc.v2(_.w/212,_.h/208),p=o.round(188*-m.x/2),h=o.round(192*-m.y/2);Object.assign(e,{formalCellSize:_,formalCellScale:m,offsetWidth:p,offsetHeight:h});const g=cc.find("Canvas/sample_nodes/tile_cell");this.gridContainer.width=u,this.gridContainer.height=d,this.gridContainer.removeAllChildren(!0),a.graphicLib.spriteFrameToSpriteFrameGrid(l,c,n,s,p,h,e=>{e.some((e,t)=>{e.map((e,i)=>{const l=o.copyNode(g,this.gridContainer);l.cellPos=cc.v2(i,t),i||t||(this.bottomLeftTile=l),l.width=_.w,l.height=_.h,l.setPosition(i*_.w,t*_.h),a.control.initTileControl(l);const r=cc.find("tile_graphic",l);r.setPosition(p,h),r.getComponent(cc.Sprite).spriteFrame=e;const c=this.cellPosToMaskTileName(i,t,n,s),u=a.resources.getMaskTileTextureByName(c);r.getComponent("shader_alpha_mask").updateRender(u);const d=o.copyNode(a.resources.getTileShadowNodeByName(c),this.gridContainer);o.setGlobalPosToNode(d,l),d.scaleX=m.x,d.scaleY=m.y,d.anchorX=.16,d.anchorY=.25,l.shadowNode=d;const f=o.copyNode(a.resources.getTileHighlightNodeByName(c),l);f.scaleX=m.x,f.scaleY=m.y,f.setPosition(0,0),f.anchorX=.2067,f.anchorY=.212,f.active=!1,f.name="highlight";const b=l.getComponent(cc.BoxCollider);b.offset.x=l.width/2,b.offset.y=l.height/2,b.size.width=l.width+.6*_.w,b.size.height=l.height+.6*_.h,this.tileDown(l)})}),t&&t()}),this.currentTileCount=n*s,this.currentTileSize=(_.w+_.h)/2;const f=a.resources.getInputPictureSpriteByName(i);[this.previewPhotoNode,this.opaquePhotoNode,this.finalPhotoNode].map(e=>{e.getComponent(cc.Sprite).spriteFrame=f,Object.assign(e,this.currentPictureFitSize)})},cellPosToMaskTileName(e,t,i,a){const o=a-t-1;let n="tile-inner1";return 0==o?n=0==e?"tile-corner-top-left":e==i-1?"tile-corner-top-right-"+(i%2==1?"odd":"even"):"tile-border-top"+(e%2==1?"1":"2"):o==a-1?n=0==e?"tile-corner-bottom-left-"+(a%2==1?"odd":"even"):e==i-1?"tile-corner-bottom-right-"+((i+a)%2==1?"odd":"even"):"tile-border-bottom"+((e+a)%2==1?"1":"2"):0==e?n="tile-border-left"+(o%2==1?"1":"2"):e==i-1?n="tile-border-right"+((o+i)%2==1?"1":"2"):(e+o)%2==1&&(n="tile-inner2"),n},tileUp(e){e.isUp=!0,e.zIndex=100,e.shadowNode.zIndex=50,a.coreGame.isTileSurroundedShadow(e)||(e.shadowNode.active=!0)},tileDown(e){e.isUp=!1,e.zIndex=1,e.shadowNode.active=!1},tileHighlightOn(e){e.isHighlighted=!0,cc.find("highlight",e).active=!0},tileHighlightOff(e){e.isHighlighted=!1,cc.find("highlight",e).active=!1}},cc._RF.pop()},{"../system/all_modules":"all_modules"}],project_init_comp:[function(e,t,i){"use strict";cc._RF.push(t,"627802AmqJKc6KbJDmiTk8k","project_init_comp");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,s=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(n<3?o(s):n>3?o(t,i,s):o(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});const o=e("../system/all_modules"),n=o._,{ccclass:s,property:l}=cc._decorator;let r=class extends cc.Component{constructor(){super(...arguments),this.futuraBoldFont=null,this.futuraMedFont=null}start(){window._G=o}onLoad(){cc.game.on(cc.game.EVENT_SHOW,()=>o.appEvents.onAppShow()),cc.game.on(cc.game.EVENT_HIDE,()=>o.appEvents.onAppHide()),n.setTimeout(()=>{const e=document.getElementById("htmlLoadingBackground");e&&(e.style.display="none")},500),cc.director.getCollisionManager().enabled=!0;for(let e in o)o[e].init&&o[e].init()}};a([l(cc.Font)],r.prototype,"futuraBoldFont",void 0),a([l(cc.Font)],r.prototype,"futuraMedFont",void 0),r=a([s],r),i.default=r,cc._RF.pop()},{"../system/all_modules":"all_modules"}],resources_manager:[function(e,t,i){"use strict";cc._RF.push(t,"fb726ZRtJVHN7gVyH2InXHZ","resources_manager"),Object.defineProperty(i,"__esModule",{value:!0}),i.resources=void 0;const a=e("../system/all_modules"),o=a._;i.resources={pictureContainer:null,maskTilePixelArrList:{},isReady:!1,textureQueueCount:0,extPictureQueueCount:0,callbackArr:[],addInitCallback(e){if(this.isReady)return e();this.callbackArr.push(e)},initData(e){this.pictureContainer=cc.find("Canvas/sprite_frames_store/input_pictures"),this.handleExternalPictures(e)},getInputPicrures(){return this.pictureContainer.children},handleExternalPictures(e){this.pictureContainer.removeAllChildren();const t=[];this.extPictureQueueCount=e.length,e.map((e,i)=>{const{id:n,name:s,imageUrl:l,url:r,description:c,width:u,height:d}=e;cc.assetManager.loadRemote(l,cc.SpriteFrame,(s,l)=>{if(s)return o.log(">> error loading external data ",s);const r=new cc.Node;t[i]=r,r.name=a.levelManager.picInfoToPicName(n),r.metaData=e,r.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(l),this.extPictureQueueCount--})}),o.waitToRun(()=>{t.map(e=>{this.pictureContainer.addChild(e),o.setTimeout(()=>{Object.assign(e,a.mapVisual.getPictureFitSize(e))})}),this.prepareMaskTiles()},"!extPictureQueueCount",this)},preprocessInputPicture(e,t,i){a.mapVisual.getPictureFitSize({width:t,height:i})},prepareMaskTiles(){cc.find("Canvas/sprite_frames_store").active=!1;const e=cc.find("Canvas/sprite_frames_store/mask_tiles").children;this.textureQueueCount=e.length,e.map(e=>{const t=e.getComponent(cc.Sprite).spriteFrame;a.graphicLib.spriteFrameToPixelArr(t,t=>{this.maskTilePixelArrList[e.name]={data:t,width:e.width,height:e.height},this.textureQueueCount--})}),o.waitToRun(()=>{this.isReady=!0,this.callbackArr.map(e=>e())},"!textureQueueCount",this)},getMaskTileTextureByName(e){const t=this.maskTilePixelArrList[e];return t?a.graphicLib.pixelArrToSpriteFrame(t.data,t.width,t.height):o.log(`texture "${e}" is not ready !!!`)},getInputPictureSpriteByName:e=>cc.find(`Canvas/sprite_frames_store/input_pictures/${e}`).getComponent(cc.Sprite).spriteFrame,getTileShadowNodeByName:e=>cc.find(`Canvas/sprite_frames_store/mask_tile_shadows/${e}`),getTileHighlightNodeByName:e=>cc.find(`Canvas/sprite_frames_store/mask_tile_highlights/${e}`),getPictureNameArr(){return this.pictureContainer.children.map(e=>e.name)}},cc._RF.pop()},{"../system/all_modules":"all_modules"}],scrollview_row_comp:[function(e,t,i){"use strict";cc._RF.push(t,"a6f7bmbU5xOS5H0MvLFtOuA","scrollview_row_comp");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,s=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(n<3?o(s):n>3?o(t,i,s):o(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0}),e("../../system/all_modules")._;const{ccclass:o,property:n}=cc._decorator;let s=class extends cc.Component{onLoad(){this.node.opacity=255}onCollisionEnter(e,t){t.node.opacity=255}onCollisionExit(e,t){t.node.opacity=0}};s=a([o],s),i.default=s,cc._RF.pop()},{"../../system/all_modules":"all_modules"}],settings_view:[function(e,t,i){"use strict";cc._RF.push(t,"7a0aaluD6NMPLK9qKx2YYi7","settings_view"),Object.defineProperty(i,"__esModule",{value:!0}),i.settingsView=void 0;const a=e("../../system/all_modules"),o=a._;i.settingsView={node:null,init(){},bindButtonHandlers(){a.utilsUI.makeButton("Canvas/HUD_top/player_level/button_settings",()=>{this.node.active=!0}),a.utilsUI.makeButton(cc.find("root/btn_close",this.node),()=>{this.node.active=!1})},renderLanguageButtons(){const e=cc.find("root/ScrollView/mask/content",this.node),t=cc.find("Canvas/sample_nodes/settings_language_button"),i=e.children;a.localize.supportedLanguageArr.map(({code:n,name:s},l)=>{const r=i[l]||o.copyNode(t,e);a.utilsUI.fillChildLabelByPath(r,"label_language_name",s),cc.find("selected_cover",r).active=a.localize.currentLanguageCode===n,r.isBoundHandler||(r.isBoundHandler=!0,a.utilsUI.makeButton(r,()=>{a.localize.onLanguageChanges(n),this.renderLanguageButtons()}))})},bindSoundButtonHandlers(){a.utilsUI.makeButton("Canvas/settings_layout/root/btn_music_off",()=>{a.audio.isMusicOff=!1,a.audio.playBgMusic(),this.renderAllSoundButtons(),a.utilsData.save({isMusicOff:!1})}),a.utilsUI.makeButton("Canvas/settings_layout/root/btn_music_on",()=>{a.audio.isMusicOff=!0,a.audio.stopBgMusic(),this.renderAllSoundButtons(),a.utilsData.save({isMusicOff:!0})}),a.utilsUI.makeButton("Canvas/settings_layout/root/btn_sound_off",()=>{a.audio.isSoundOff=!1,this.renderAllSoundButtons(),a.utilsData.save({isSoundOff:!1})}),a.utilsUI.makeButton("Canvas/settings_layout/root/btn_sound_on",()=>{a.audio.isSoundOff=!0,this.renderAllSoundButtons(),a.utilsData.save({isSoundOff:!0})})},renderAllSoundButtons(){cc.find("root/btn_music_off",this.node).active=a.audio.isMusicOff,cc.find("root/btn_sound_off",this.node).active=a.audio.isSoundOff,cc.find("root/btn_music_on",this.node).active=!a.audio.isMusicOff,cc.find("root/btn_sound_on",this.node).active=!a.audio.isSoundOff}},cc._RF.pop()},{"../../system/all_modules":"all_modules"}],shader_alpha_mask:[function(e,t,i){"use strict";cc._RF.push(t,"daff6JBCl9PXo0HpdCEujAL","shader_alpha_mask");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,s=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(n<3?o(s):n>3?o(t,i,s):o(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0}),e("../../script/system/all_modules")._;const{ccclass:o,property:n}=cc._decorator;let s=class extends cc.Component{constructor(){super(...arguments),this.maskTexture=null}updateRender(e){this.maskTexture=e;const t=this.node.getComponent(cc.Sprite).getMaterial(0);t.setProperty("texture_mask",this.maskTexture.getTexture()),(this.node.getComponent(cc.RenderComponent)||this.node.addComponent(cc.RenderComponent)).setMaterial(0,t)}};a([n(cc.SpriteFrame)],s.prototype,"maskTexture",void 0),s=a([o],s),i.default=s,cc._RF.pop()},{"../../script/system/all_modules":"all_modules"}],shader_shadow:[function(e,t,i){"use strict";cc._RF.push(t,"4c344V5+cNLVaGXfe+IIJIZ","shader_shadow");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,s=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(n<3?o(s):n>3?o(t,i,s):o(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0}),e("../../script/system/all_modules")._;const{ccclass:o,property:n}=cc._decorator;let s=class extends cc.Component{constructor(){super(...arguments),this.mainTexture=null}updateRender(e){this.mainTexture=e;const t=this.node.getComponent(cc.Sprite).getMaterial(0);t.setProperty("main_texture",this.mainTexture.getTexture()),(this.node.getComponent(cc.RenderComponent)||this.node.addComponent(cc.RenderComponent)).setMaterial(0,t)}};a([n(cc.SpriteFrame)],s.prototype,"mainTexture",void 0),s=a([o],s),i.default=s,cc._RF.pop()},{"../../script/system/all_modules":"all_modules"}],system_types:[function(e,t,i){"use strict";cc._RF.push(t,"9a378sc4D1PKauhxf7mEMi/","system_types"),Object.defineProperty(i,"__esModule",{value:!0}),i.AchievementEntry=i.achievementTask=i.achievementReward=i.QuestEntry=i.chestReward=i.questReward=i.questTask=i.rewardDaily=void 0;const a=e("./all_modules")._;(function(e){e.Cash="Cash",e.CashTime="CashTime",e.Gem="Gem",e.SpeedUp="SpeedUp",e.Plane="Plane"})(i.rewardDaily||(i.rewardDaily={})),function(e){e.Login="Login",e.MergePlane="MergePlane",e.WatchVideo="WatchVideo",e.InviteFriends="InviteFriends",e.SpeedUp="SpeedUp"}(i.questTask||(i.questTask={})),function(e){e.Cash="Cash",e.Gem="Gem",e.CashTime="CashTime"}(i.questReward||(i.questReward={})),function(e){e.Cash="Cash",e.Gem="Gem",e.Plane="Plane",e.CashTime="CashTime"}(i.chestReward||(i.chestReward={})),i.QuestEntry=class{constructor(e){this.uuid=a.getNewUuid(),Object.assign(this,e)}},(i.achievementReward||(i.achievementReward={})).Gem="Gem",(i.achievementTask||(i.achievementTask={})).MergePlane="MergePlane",i.AchievementEntry=class{constructor(e){this.uuid=a.getNewUuid(),Object.assign(this,e)}},cc._RF.pop()},{"./all_modules":"all_modules"}],tile_comp:[function(e,t,i){"use strict";cc._RF.push(t,"bd13a1nRSxO9oG48AZjd269","tile_comp");var a=this&&this.__decorate||function(e,t,i,a){var o,n=arguments.length,s=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,a);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(s=(n<3?o(s):n>3?o(t,i,s):o(t,i))||s);return n>3&&s&&Object.defineProperty(t,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});const o=e("../system/all_modules")._,{ccclass:n,property:s}=cc._decorator;let l=class extends cc.Component{onCollisionEnter(e,t){const[i,a]=[t.node,e.node];i.collidingTileArr.push(a)}onCollisionExit(e,t){const[i,a]=[t.node,e.node];o.removeArrayItem(i.collidingTileArr,a)}};l=a([n],l),i.default=l,cc._RF.pop()},{"../system/all_modules":"all_modules"}],user_model:[function(e,t,i){"use strict";cc._RF.push(t,"cd000qpQJRCKZjwxlsdTXBW","user_model"),Object.defineProperty(i,"__esModule",{value:!0}),i.userModel=void 0;const a=e("../system/all_modules"),o=a._;let n=(new Date).getMonth()+1;n<10&&(n="0"+n),i.userModel={lastDataSaveTimeUTC:0,dataFieldNameArr:["lastDataSaveTimeUTC"],speedUpStartTimeUTC:0,speedupDuration:0,initCallbackArr:[],isInitialized:!1,rewardedPlaneArr:[],init(){a.login.addLoginDataFields(...this.dataFieldNameArr)},addInitCallback(e){this.isInitialized?e(a.login.loginData):this.initCallbackArr.push(e)},save(){const e={};this.dataFieldNameArr.map(t=>e[t]=this[t]),e.lastDataSaveTimeUTC=this.lastDataSaveTimeUTC=o.round(o.getMsPassedUTC()/1e3),a.utilsData.save(e)}},cc._RF.pop()},{"../system/all_modules":"all_modules"}],utils_anim_fx:[function(e,t,i){"use strict";cc._RF.push(t,"25b45wNZcZF7Jc+YiGRe0VU","utils_anim_fx"),Object.defineProperty(i,"__esModule",{value:!0}),i.utilsAnimFx=void 0;const a=e("../../system/all_modules"),o=a._;i.utilsAnimFx={fxNodePool:{},init(){},replayParticle(e){e&&e.getComponent(cc.ParticleSystem)&&(e.active=!0,e.getComponent(cc.ParticleSystem).resetSystem())},playNodeAnim(e,t,i,a=!1,o){const n=e.getComponent(cc.Animation);if(!e.activeInHierarchy||!n)return;if(!(t=t||(n.defaultClip?n.defaultClip.name:"")))return;const s=n[a?"playAdditive":"play"](t);return s?(s.repeatCount=(-1==i?1/0:i)||1,o&&n.on("finished",()=>{n.off("finished"),o()}),s):void 0},playNodeAnimAsSoonAsNodeActive(e,t,i=1,a=!0){const n="waitInterval2PlayAnimWhenActive";e[n]=o.waitToRun(()=>{e[n]&&clearInterval(e[n]),this.playNodeAnim(e,t,i,a)},"activeInHierarchy",e)},playNodeAnimArr(e,t,i=!1,a){if(!e.activeInHierarchy)return;const o=e.getComponent(cc.Animation);if(!e.activeInHierarchy||!o)return;const n=[...t];o.on("finished",()=>{n.length?this.playNodeAnim(e,n.shift(),1,i):(o.off("finished"),a&&a())}),this.playNodeAnim(e,n.shift(),1,i)},stopAllNodeAnims(e){const t=e.getComponent(cc.Animation);t&&(t.stop(),t.off("finished"))},stopAnimAtFrame0(e,t){const i=e.getComponent(cc.Animation);i.play("ufo_ring_fx"),o.setTimeout(()=>{i.setCurrentTime(0),this.stopAllNodeAnims(e)})},playIncreasingNumberLabel(e,t,i,a=5,n=.5,s=0,l="xxx"){const r=e.getComponent(cc.Label),c=i/a,u=n/a;cc.tween(e).delay(s).repeat(a,cc.tween().call(()=>{t+=c;const e=o.formatMoney(o.round(t));r.string=l.replace(/xxx/g,e)}).delay(u)).start()},getNewFxNode(e,t){e.nodePoolId||(e.nodePoolId=o.getNewUuid()),this.fxNodePool[e.nodePoolId]||(this.fxNodePool[e.nodePoolId]=[]);const i=this.fxNodePool[e.nodePoolId].pop()||o.copyNode(e);return i.nodePoolId=e.nodePoolId,i.parent=t||a.coreFX.fxContainer,i},saveFxNodeToPool(e){e.stopAllActions(),e.active=!1,this.fxNodePool[e.nodePoolId].unshift(e)},particlesFlyFromA2B(e,t,i,n,s){const{numberOfNode:l,flyDuration:r,delayStartTime:c,randomBezierPointRange:u}=n||a.configAnimFx.defaultParticleFlyA2BConfigs,d=o.getGlobalPosDiff(t,i);for(let a=0;a<l;a++){const i=this.getNewFxNode(e,s);i.active=!0,o.setGlobalPosToNode(i,t);const n=this.getRandomPointInRage(u),l=this.getRandomPointInRage(u);cc.tween(i).delay(a*c).bezierBy(r,n,l,d).call(()=>{this.saveFxNodeToPool(i)}).start()}},getRandomPointInRage:e=>cc.v2(o.randomNumber(2*e.x)-e.x,o.randomNumber(2*e.y)-e.y),nodeFlyFromAtoB(e,t,i=.3,a){const n=o.getGlobalPosDiff(e,t);cc.tween(e).by(i,{position:n}).call(()=>a&&a()).start()}},cc._RF.pop()},{"../../system/all_modules":"all_modules"}],utils_common:[function(e,t,i){"use strict";cc._RF.push(t,"7c6a38LFRNHfqlBBkLI3s1j","utils_common"),Object.defineProperty(i,"__esModule",{value:!0}),i._=void 0;let a=1e5;const o=e("./utils_time");i._=Object.assign(Object.assign({NO_CONSOLE_LOG:!1,isANDROID:cc.sys.os==cc.sys.OS_ANDROID,isIOS:cc.sys.os==cc.sys.OS_IOS,max:Math.max,min:Math.min,round:Math.round,floor:Math.floor,ceil:Math.ceil,sign:Math.sign,abs:Math.abs,pow:Math.pow,random:Math.random,sqrt:Math.sqrt,sin:Math.sin,cos:Math.cos,tan:Math.tan,atan:Math.atan,atan2:Math.atan2,log10:Math.log10,PI:Math.PI,setInRange:(e,t,a)=>i._.max(i._.min(e,t),a),randomArrItem(e,t=!1){const i=Math.floor(Math.random()*e.length);return t?e.splice(i,1)[0]:e[i]},isString:e=>"string"==typeof e,isFunction:e=>e&&"[object Function]"==={}.toString.call(e),log(...e){if(!this.NO_CONSOLE_LOG)try{console.log(...e)}catch(t){}},trimStr:(e,t,i="")=>e.length<=t?e:e.substring(0,t)+i,getNewUuid:()=>a++,removeArrayItem(e,t){const i=e.indexOf(t);-1!=i&&e.splice(i,1)},addUniqueElemToArr(e,t){e.includes(t)||e.push(t)},randomNumber:e=>i._.floor(i._.random()*e),getGlobalPosition:e=>e.convertToWorldSpaceAR(cc.Vec2.ZERO),getGlobalPosDiff(e,t){return this.getGlobalPosition(t).sub(this.getGlobalPosition(e))},setGlobalPosToNode(e,t){const i=this.getGlobalPosition(t),a=e.parent.convertToNodeSpaceAR(i);e.setPosition(a)},setGlobalPos(e,t){const i=e.parent.convertToNodeSpaceAR(t);e.setPosition(i)},moveToNewParentKeepPosition(e,t){const i=t.convertToNodeSpaceAR(this.getGlobalPosition(e));e.parent=t,e.setPosition(i)},isGlobalOverlapping:(e,t)=>cc.Intersection.rectRect(e.getBoundingBoxToWorld(),t.getBoundingBoxToWorld()),copyNode(e,t){const i=cc.instantiate(e);return t&&(i.parent=t),i},getNodePath(e){let t=[e.name],i=e.parent,a=0;for(;i&&a++<50&&i.parent;)t.push(i.name),i=i.parent;return t.reverse().join("/")}},o.default),{radianToDegrees:e=>180*e/Math.PI,degreesToRadian:e=>e*Math.PI/180,formatTime(e){let t=i._.floor(e/3600),a=i._.floor(e%3600/60),o=e%3600%60;return t<10&&(t="0"+t),a<10&&(a="0"+a),o<10&&(o="0"+o),("00"==t?"":t+":")+a+":"+o},formatMoney(e){let t=i._.floor(Math.log10(e))+1;if(t<=6)return e.toLocaleString();let a,o=i._.floor((t-1)/3);return a=o-2<=3?["K","M","B","T"][o-2]:String.fromCharCode((o-6)/26+"a".charCodeAt(0))+String.fromCharCode((o-6)%26+"a".charCodeAt(0)),i._.round(e/i._.pow(10,3*(o-1))).toLocaleString()+a},paddNumberToFitDigitLength(e,t){const i=""+e,a=t-i.length;return a<=0?e:"0".repeat(a)+i}}),cc._RF.pop()},{"./utils_time":"utils_time"}],utils_data:[function(e,t,i){"use strict";cc._RF.push(t,"769b1HrFnpEkJKKpSJ/BVzB","utils_data"),Object.defineProperty(i,"__esModule",{value:!0}),i.utilsData=void 0,e("../../system/all_modules")._,i.utilsData={save(e,t){if(window.FBInstant)FBInstant.player.setDataAsync(e).then(()=>{t&&t()},e=>console.warn(" utils_data >> save >> failed ",e)).catch(e=>console.warn(" utils_data >> save >> failed (catch) ",e));else{for(let t in e)localStorage.setItem(t,JSON.stringify(e[t]));setTimeout(()=>{t&&t()},300)}},load(e,t){if(window.FBInstant)FBInstant.player.getDataAsync(e).then(e=>{t&&t(e)});else{const i={};e.map(e=>{if(null!==localStorage.getItem(e))try{i[e]=JSON.parse(localStorage.getItem(e))}catch(t){console.warn(` utilsData.load() >> Error  data key = ${e} `,t)}}),t&&setTimeout(()=>t(i),100)}},getEntryPointData:()=>window.FBInstant&&FBInstant.getEntryPointData()||{}},cc._RF.pop()},{"../../system/all_modules":"all_modules"}],utils_time:[function(e,t,i){"use strict";cc._RF.push(t,"233be6H/0VKNYjn2mjsWkCF","utils_time"),Object.defineProperty(i,"__esModule",{value:!0}),e("../../system/all_modules")._;let a=1e5;i.default={getMsPassedUTC:()=>(new Date).getTime(),getMsPassedPT(){const e=this.getPacificTimeOffset();return this.getMsPassedUTC()+36e5*e},getTimePT(e=new Date){const t=this.getPacificTimeOffset(e),i=e.getHours()+e.getTimezoneOffset()/60;return e.setHours(i+t),e},isSameDate:(e,t)=>e.getFullYear()==t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate(),getTotalMsToMidnightPT(){return 864e5-this.getMsPassedPT()%864e5},getDSTStartEndDate(e){const t=(e||new Date).getFullYear(),i=new Date(t,2,1),a=(7-i.getDay())%7,o=i.getDate()+a+7,n=new Date(t,2,o),s=new Date(t,10,1),l=(7-s.getDay())%7,r=s.getDate()+l;return[n,new Date(t,10,r)]},getPacificTimeOffset(e){const t=e||new Date,[i,a]=this.getDSTStartEndDate();return t>i&&t<a?-7:-8},getMonthName:e=>["January","February","March","April","May","June","July","August","September","October","November","December"][(e=e||new Date).getMonth()],setTimeout(e,t=0){const i={_id:a++,__instanceId:a,callback:null};return i.callback=()=>{e(i)},cc.director.getScheduler().schedule(i.callback,i,t/1e3,0,0,!1),i},clearTimeout(e){e&&e._id&&e.callback&&cc.director.getScheduler().unschedule(e.callback,e)},setInterval(e,t=0){const i={_id:a++,__instanceId:a,callback:null};return i.callback=()=>{e(i)},cc.director.getScheduler().schedule(i.callback,i,t/1e3,cc.macro.REPEAT_FOREVER,0,!1),i},clearInterval(e){e&&e._id&&e.callback&&cc.director.getScheduler().unschedule(e.callback,e)},secondsToTimeCountdown(e=0){if(e<=0)return"00:00";let t=Math.floor(e/86400),i=Math.floor(e%86400/3600),a=Math.floor(e%3600/60),o=e%60;if(t>2)return t+" days";if(1==t)return"1 day";let n="";return i>=10?n=i+":":i>0&&(n="0"+i+":"),(n+=a>=10?a+":":"0"+a+":")+(o>=10?o:"0"+o)},waitToRun(e,t,i=window,a=.1,o,n){let s=!1;const l=t.startsWith("!"),r=t.endsWith("()");t=t.replace("!","").replace("()","");const c=r?()=>i[t]():null,u=setInterval(()=>{if(l){if(r){if(c())return}else if(i[t])return}else if(r){if(!c())return}else if(!i[t])return;clearInterval(u),s=!0,e(i[t])},1e3*a);return o&&this.setTimeout(()=>{clearInterval(u),n&&!s&&n()},1e3*o),u}},cc._RF.pop()},{"../../system/all_modules":"all_modules"}],utils_ui:[function(e,t,i){"use strict";cc._RF.push(t,"b08e1le7AhElZTc77BxLM+1","utils_ui"),Object.defineProperty(i,"__esModule",{value:!0}),i.utilsUI=void 0;const a=e("../../system/all_modules"),o=a._;i.utilsUI={fillLabel(e,t){e.getComponent(cc.Label).string=t},fillChildLabelByPath(e,t,i){const a=cc.find(t,e);a&&(a.getComponent(cc.Label).string=i)},showOnlyChildNodeWithNameAs(e,t){let i;return e.children.map(e=>{e.active=e.name==t,e.active&&(i=e)}),i},setLabelCountDownTimer(e,t,i){"string"==typeof e&&(e=cc.find(e)),e.countDownTimerVar&&clearInterval(e.countDownTimerVar);const n=()=>{if(!e.parent)return clearInterval(e.countDownTimerVar);const n=t-o.getMsPassedUTC(),s=o.secondsToTimeCountdown(o.floor(n/1e3));a.utilsUI.fillLabel(e,s),n<=0&&(clearInterval(e.countDownTimerVar),i&&i())};e.countDownTimerVar=setInterval(n,500),n()},setNodeSprite(e,t){e&&e.getComponent(cc.Sprite)&&(e.getComponent(cc.Sprite).spriteFrame=t)},setNodeSpriteFromUrl(e,t,i,a=!1){e&&e.getComponent(cc.Sprite)&&(a&&e.getComponent(cc.Sprite).spriteFrame||cc.assetManager.loadRemote(t,(t,a)=>(t||this.setNodeSprite(e,new cc.SpriteFrame(a)),i&&i())))},setNodeSpriteFillRange(e,t){e&&e.getComponent(cc.Sprite)&&(e.getComponent(cc.Sprite).fillRange=t)},makeButton(e,t,i=!1,n=!1){const s=o.isString(e)?cc.find(e):e;o.setTimeout(()=>{if(s.getComponent("free_button_comp"))return;s.addComponent("free_button_comp");const e=s.addComponent(cc.Button);e.transition=i?null:cc.Button.Transition.SCALE;const o=new cc.Component.EventHandler;o.target=s,o.component="free_button_comp",o.handler="freeHandler",e.clickEvents.push(o),s.freeButtonHandlerFunc=()=>{t(),n||a.audio.playSoundClickButton()}})},singleTouchSet(e,t,i,a){const o=(e,t)=>{e(t.touch.getLocation(),t)};e.on("touchstart",i=>{e._customTouchId||(e._customTouchId=i.touch._id+1,t&&o(t,i))}),i&&e.on("touchmove",t=>{t.touch._id+1==e._customTouchId&&i&&o(i,t)});var n=t=>{t.touch._id+1==e._customTouchId&&(e._customTouchId=null,a&&o(a,t))};e.on("touchend",n),e.on("touchcancel",n)},makeDraggable(e){let t;a.utilsUI.singleTouchSet(e,i=>{t=o.getGlobalPosition(e).sub(i)},i=>{o.setGlobalPos(e,i.add(t))},()=>{})},fixScrollViewPerformance(e,t,i=4){if(!t.rowVisibleCollider){t.rowVisibleCollider=!0;const a=t.parent,n=t.rowVisibleCollider=new cc.Node("scrollview_item_display_area");n.group="scrollview",this.addSimpleBoxColliderComp(n,a),n.parent=a,e.on("active-in-hierarchy-changed",()=>{e.active?o.setTimeout(()=>{t.children.map((e,t)=>{e.active=!0,e.opacity=t<i?255:0})},500):t.children.map((e,t)=>{e.active=t<i})})}t.children.map((t,a)=>{t.getComponent("scrollview_row_comp")||(t.addComponent("scrollview_row_comp"),this.addSimpleBoxColliderComp(t),t.group="scrollview"),t.active=!!e.active||a<i})},addSimpleBoxColliderComp(e,t){t=t||e;const i=e.addComponent(cc.BoxCollider);i.size.width=t.width,i.size.height=t.height,i.offset.x=t.width*(.5-t.anchorX),i.offset.y=t.width*(.5-t.anchorY)}},cc._RF.pop()},{"../../system/all_modules":"all_modules"}]},{},["control","core_game","game_flow","graphic_lib","level_manager","map_visual","shader_alpha_mask","shader_shadow","tile_comp","core_fx","core_ui","user_model","settings_view","audio","free_button_comp","scrollview_row_comp","utils_anim_fx","utils_common","utils_data","utils_time","utils_ui","all_modules","anim_event_comp","app_events","config_anim_fx","en_US","es_ES","localize","login","project_init_comp","resources_manager","system_types"]);