window.__require=function e(t,n,r){function o(i,c){if(!n[i]){if(!t[i]){var l=i.split("/");if(l=l[l.length-1],!t[l]){var s="function"==typeof __require&&__require;if(!c&&s)return s(l,!0);if(a)return a(l,!0);throw new Error("Cannot find module '"+i+"'")}i=l}var u=n[i]={exports:{}};t[i][0].call(u.exports,function(e){return o(t[i][1][e]||e)},u,u.exports,e,t,n,r)}return n[i].exports}for(var a="function"==typeof __require&&__require,i=0;i<r.length;i++)o(r[i]);return o}({all_modules:[function(e,t,n){"use strict";cc._RF.push(t,"f9a13gU659N2591e/me8aLj","all_modules"),n.__esModule=!0;var r=e("./configs");Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&(n[e]=r[e])});var o=e("./utils/utils");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&(n[e]=o[e])});var a=e("./utils/utils_facebook");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&(n[e]=a[e])});var i=e("./utils/audio");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&(n[e]=i[e])});var c=e("./ui-fx/ui");Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&(n[e]=c[e])});var l=e("./logic/login");Object.keys(l).forEach(function(e){"default"!==e&&"__esModule"!==e&&(n[e]=l[e])});var s=e("./logic/data");Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&(n[e]=s[e])});var u=e("./logic/game");Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&(n[e]=u[e])});var d=e("./logic/game_flow");Object.keys(d).forEach(function(e){"default"!==e&&"__esModule"!==e&&(n[e]=d[e])});var f=e("./logic/user");Object.keys(f).forEach(function(e){"default"!==e&&"__esModule"!==e&&(n[e]=f[e])});var p=e("./core/control");Object.keys(p).forEach(function(e){"default"!==e&&"__esModule"!==e&&(n[e]=p[e])});var g=e("./core/map");Object.keys(g).forEach(function(e){"default"!==e&&"__esModule"!==e&&(n[e]=g[e])});var m=e("./core/map_visual");Object.keys(m).forEach(function(e){"default"!==e&&"__esModule"!==e&&(n[e]=m[e])});var h=e("./social/social");Object.keys(h).forEach(function(e){"default"!==e&&"__esModule"!==e&&(n[e]=h[e])}),cc._RF.pop()},{"./configs":"configs","./core/control":"control","./core/map":"map","./core/map_visual":"map_visual","./logic/data":"data","./logic/game":"game","./logic/game_flow":"game_flow","./logic/login":"login","./logic/user":"user","./social/social":"social","./ui-fx/ui":"ui","./utils/audio":"audio","./utils/utils":"utils","./utils/utils_facebook":"utils_facebook"}],audio:[function(e,t,n){"use strict";cc._RF.push(t,"0dbdefX+KJNw74ONUGHT3DL","audio"),n.__esModule=!0,n.audio=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function a(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=i(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function i(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l={audioList:{},playingIdList:{},isSoundOff:!0,init:function(){var e=this;r.login.addLoginDataField("isSoundOff"),r.login.addCallback(function(t){e.isSoundOff=t.isSoundOff,e.loadAudios()})},renderBtnSound:function(){cc.find("Canvas/layer_pause/btn_sound_off").active=this.isSoundOff},loadAudios:function(){var e=this;cc.resources.loadDir("audios",cc.AudioClip,function(t,n){if(t)return _log(t);for(var r,o=a(n);!(r=o()).done;){var i=r.value;e.audioList[i.name]=i}})},playSound:function(e,t){if(void 0===t&&(t=1),!this.isSoundOff&&this.audioList[e])try{this.playingIdList[e]=cc.audioEngine.play(this.audioList[e],!1,t)}catch(n){}},stopSound:function(e){this.playingIdList[e]&&cc.audioEngine.stopEffect(this.playingIdList[e])},playMusic:function(){if(!this.isSoundOff&&!cc.audioEngine.isMusicPlaying())try{this.playingIdList.theme_music=cc.audioEngine.playMusic(this.audioList.theme_music,!0,1)}catch(e){_log("playMusic err ",e)}},stopMusic:function(){cc.audioEngine.isMusicPlaying()&&cc.audioEngine.stopMusic()},playSoundClickButton:function(){this.isSoundOff||this.playSound("tap_sound",.2)}};n.audio=l,cc._RF.pop()},{"../all_modules":"all_modules"}],block_collider:[function(e,t){"use strict";cc._RF.push(t,"62b58UVkeREOIl2E7oGry+4","block_collider");var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}cc.Class({extends:cc.Component,onBeginContact:function(e,t,r){var o=r.node.name,a=this.node.name;if("map_base"!=a||"map_base"!=o){var i=this.node.getComponent(cc.RigidBody).linearVelocity.mag()>20;if("map_base"==o){if("map_base"==a)return;this.node.name="map_base",n.game.onBlockTouchBase(this.node)}else if("alert_line"==o){if(!i||this.node.isFreeNode)return}else if("drop_line"==o){if(!i||this.node.isFreeNode)return;var c="map_base"!=a;this.node.name=this.node.orgName,n.game.itemRemove(this.node,!1,c)}}}}),cc._RF.pop()},{"../all_modules":"all_modules"}],canvas_init:[function(e,t){"use strict";cc._RF.push(t,"280c3rsZJJKnZ9RqbALVwtK","canvas_init");var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("./all_modules"));function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}cc.Class({extends:cc.Component,onLoad:function(){for(var e in window._G=n,n)if(n[e].init)try{n[e].init()}catch(r){cc.warn(" ### error _G."+e+".init() >> ",r)}n.utilsFB.log("ev_game_load_time",performance.now()),n.cocosLoadTime=(performance.now()/1e3).toFixed(2),n.utils.setLabelText(cc.find("Canvas/layer_pause/label_load_time"),n.cocosLoadTime),n.utils.setTimeout(function(){n.social.askBotSubscribe(function(){return n.social.askShortcut()})},1e3);var t=document.getElementById("htmlLoadingBackground");t&&(t.style.display="none")}}),cc._RF.pop()},{"./all_modules":"all_modules"}],challenge:[function(e,t,n){"use strict";cc._RF.push(t,"91a906+OWtOG7cHD6oui68n","challenge"),n.__esModule=!0,n.challenge=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a={friendArr:[],selectedFriend:{id:0,score:0,name:0,photo:0},challengedFriendArr:[],lastTimeResetChallengedFriendArr:[],challengeCancelTimeArr:[],init:function(){var e=this;setTimeout(function(){return e.renderUserNameAndAva()},1e3),r.login.addLoginDataField("challengedFriendArr"),r.login.addLoginDataField("lastTimeResetChallengedFriendArr"),r.login.addLoginDataField("challengeCancelTimeArr"),r.login.addCallback(function(t){e.challengeCancelTimeArr=t.challengeCancelTimeArr||[],_log("init >> this.challengeCancelTimeArr = ",e.challengeCancelTimeArr),window.FBInstant?FBInstant.player.getConnectedPlayersAsync().then(function(e){r.challenge.friendArr=e.map(function(e){return{id:e.getID(),photo:e.getPhoto(),name:e.getName(),score:0,rank:0}}),_log(" getConnectedPlayersAsync 222 >> _G.challenge.friendArr = ",r.challenge.friendArr)}).catch(function(e){_log(" getConnectedPlayersAsync eeee",e)}):e.friendArr=[{id:"xxxxaa111",photo:"https://developer.mozilla.org/static/img/opengraph-logo.72382e605ce3.png",name:"Friend 123",score:222},{id:"xxxxaa2",photo:"https://developer.mozilla.org/static/img/opengraph-logo.72382e605ce3.png",name:"Friend 456",score:676}],e.challengedFriendArr=t.challengedFriendArr||[],e.lastTimeResetChallengedFriendArr=t.lastTimeResetChallengedFriendArr,e.lastTimeResetChallengedFriendArr||(e.lastTimeResetChallengedFriendArr=_time(),r.data.saveData({lastTimeResetChallengedFriendArr:_time()})),_time()-e.lastTimeResetChallengedFriendArr>r.configs.timeToResetChallengedFriendArr&&(e.lastTimeResetChallengedFriendArr=_time(),r.data.saveData({lastTimeResetChallengedFriendArr:_time()}),e.challengedFriendArr=[],r.data.saveData({challengedFriendArr:[]}))})},entriesToArr:function(e){for(var t=[],n=0;n<e.length;n++){var o=e[n],a={id:o.getID(),photo:o.getPhoto(),name:o.getName(),score:0,rank:0};t.push(a),a.id==r.user.id&&(r.user.bestScore=a.score||r.user.bestScore,_log(" leaderboard.entriesToArr() >> _G.user.bestScore="+r.user.bestScore+" // player.score="+a.score+" "),r.ui.updateScore())}return t},check2GetFriendAndRender:function(){var e=this,t=this.challengeCancelTimeArr.length>=r.configs.maxChallengeAskTimeIn1Day,n=this.challengeCancelTimeArr.some(function(e){return _time()-e>864e5});if(!t||n){var o=this.friendArr.filter(function(t){return t.id!=r.user.id&&!e.challengedFriendArr.find(function(e){return e.id==t.id})}),a=r.utils.randomArrItem(o);if(_log(" newFriendInfo = ",a,"availableFriendArr=",o),_log("this.friendArr=",this.friendArr),_log("this.challengedFriendArr=",this.challengedFriendArr),a)return this.selectedFriend=a,this.selectedFriend.score=this.selectedFriend.score||0,this.render(),!0}},renderUserNameAndAva:function(){r.utils.setLabelText(cc.find("Canvas/layer_challenge_friend/content_bg/players/Image_ButtonBase_player1/label_user_name"),r.user.name),r.utils.waitToRun(function(){cc.find("Canvas/layer_challenge_friend/content_bg/players/Image_ButtonBase_player1/avatar/real_avatar").getComponent(cc.Sprite).spriteFrame=r.user.avatarSpriteFrame},"avatarSpriteFrame",r.user)},render:function(){r.language.setLabelDataAndRender(cc.find("Canvas/layer_challenge_friend/content_bg/label_score"),r.utils.localizeNumber(r.user.score)),cc.assetManager.loadRemote(this.selectedFriend.photo,function(e,t){e||(cc.find("Canvas/layer_challenge_friend/content_bg/players/Image_ButtonBase_player2/avatar/real_avatar").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))}),r.utils.setLabelText(cc.find("Canvas/layer_challenge_friend/content_bg/players/Image_ButtonBase_player2/label_user_name"),this.selectedFriend.name),r.utils.setLabelText(cc.find("Canvas/layer_challenge_friend/content_bg/players/Image_ButtonBase_player1/label_score"),r.utils.localizeNumber(r.user.score)),r.utils.setLabelText(cc.find("Canvas/layer_challenge_friend/content_bg/players/Image_ButtonBase_player2/label_score"),r.utils.localizeNumber(this.selectedFriend.score))},onbtnPlayChallenge:function(){var e=this;r.social.createContext(this.selectedFriend.id,function(){r.social.playerIdSendMessage=e.selectedFriend.id,r.ui.hideLayer("layer_challenge_friend"),r.gameFlow.replay(),e.challengedFriendArr.push(e.selectedFriend),r.data.saveData({challengedFriendArr:e.challengedFriendArr}),_log(" onbtnPlayChallenge >> _G.challenge.resetChallengCancelTimeArr(); "),r.challenge.resetChallengCancelTimeArr()})},onBtnPlayWithAnother:function(){r.social.invite(function(e){r.social.playerIdSendMessage=e,r.ui.hideLayer("layer_challenge_friend"),r.gameFlow.replay(),_log(" onBtnPlayWithAnother >> _G.challenge.resetChallengCancelTimeArr(); "),r.challenge.resetChallengCancelTimeArr()})},resetChallengCancelTimeArr:function(){this.challengeCancelTimeArr=[],r.data.saveData({challengeCancelTimeArr:this.challengeCancelTimeArr})},onBtnCancelClicked:function(){this.challengeCancelTimeArr.push(_time()),this.challengeCancelTimeArr.length>r.configs.maxChallengeAskTimeIn1Day&&this.challengeCancelTimeArr.shift(),r.data.saveData({challengeCancelTimeArr:this.challengeCancelTimeArr}),_log(" onBtnCancelClicked >> this.challengeCancelTimeArr = ",this.challengeCancelTimeArr),r.utilsFB.log("ev_click_button_cancel_challenge"),r.ui.hideLayer("layer_challenge_friend"),r.gameFlow.replay()}};n.challenge=a,cc._RF.pop()},{"../all_modules":"all_modules"}],configs:[function(e,t,n){"use strict";cc._RF.push(t,"ebe19/GLqFNJpVsHIhv9yBI","configs"),n.__esModule=!0,n.configs=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("./all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a={freeBlock7ForNewUser:1,block7EachVideo:1,freeRemoveNewItemForNewUser:1,removeNewItemTimeEachVideo:3,timeToResetChallengedFriendArr:864e5,maxChallengeAskTimeIn1Day:5,leaderboardName:"score_global",leaderboardPlayerCount:15,isShowPromoGames:!1,listIdPromoGame:["1290260324506853","227806484682918","617940745660759"],interAdId:"312849576761966_317420549638202",interAdRatio:{gameOverReplay:1},showInterAdAfterEveryReplayTime:2,videoRewardId:"312849576761966_317420662971524",videoContinueTime:1,blocks:{1:{color:"#bca890",shadowColor:"#978069",labelColor:"#ffffff"},2:{color:"#55b2d5",shadowColor:"#3c84b1",labelColor:"#ffffff"},3:{color:"#a8775f",shadowColor:"#936854",labelColor:"#ffffff"},4:{color:"#4d6ab3",shadowColor:"#3a4b8c",labelColor:"#ffffff"},5:{color:"#56b08f",shadowColor:"#398379",labelColor:"#ffffff"},6:{color:"#9767ae",shadowColor:"#615089",labelColor:"#ffffff"},7:{color:"#ffed79",shadowColor:"#c3a056",labelColor:"#594e85"},8:{color:"#000000",shadowColor:"#000000",labelColor:"#cc0000"}},biasType:{1:["top","left","single_block"],2:["top","left","single_block"],3:["top","left"],4:["top","left","single_block"]},stepCount2BiasTypeArr:function(e){var t=0;for(var n in this.biasType){if(n>e)return this.biasType[t];n<=e&&(t=n)}return this.biasType[t]},blockNumber:{1:[1,2,3,4,5,6]},stepCount2BlockNumerArr:function(e){var t=0;for(var n in this.blockNumber){if(n>e)return this.blockNumber[t];n<=e&&(t=n)}return this.blockNumber[t]},singleBlockPoint:{1:2,2:4,3:8,4:16,5:32,6:64,7:128},scoreFactor:{3:3,4:3.5,5:5,6:6.5,7:8},calculateScore:function(e,t){return parseInt(r.configs.singleBlockPoint[e]*(r.configs.scoreFactor[t]||1))},scoringShadowColors:{2:"286cfe",3:"ff9c02",4:"1cd02b",5:"b20af8",6:"fc3937",7:"fdde43",8:"fdde43"}};n.configs=a,cc._RF.pop()},{"./all_modules":"all_modules"}],control:[function(e,t,n){"use strict";cc._RF.push(t,"7db31WzvhlJ4aXe0Piepn1e","control"),n.__esModule=!0,n.control=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a={moveHorzDragRange:30,fastFallingMinDragRange:140,fastFallingMinDragYXRatio:3,isFastFalling:!1,minTimeToRecordKeyPos:600,minRangeToRecordKeyPos:160,touchToRotateMaxRange:15,init:function(){var e,t,n,o=this,a=this.newItemNode=cc.find("Canvas/play_area/control_pad");r.utils.singleTouchSet(a,function(r){o.isFastFalling=!1,e=r,t=_time(),n=!1},function(a){if(!o.isFastFalling){var i=a.sub(e),c=i.mag();c>o.touchToRotateMaxRange&&(n=!0),c>o.fastFallingMinDragRange&&(_abs(i.x)<10||-i.y/_abs(i.x)>o.fastFallingMinDragYXRatio)?(o.isFastFalling=!0,r.game.speedUpNewItem()):_abs(i.x)>o.moveHorzDragRange?(r.game.moveNewItem(i.x>0?"right":"left"),e=a,t=_time()):(c>o.minRangeToRecordKeyPos||_time()-t>o.minTimeToRecordKeyPos)&&(e=a,t=_time())}},function(){o.isFastFalling=!1,r.game.slowDownNewItem(),n||r.game.rotateNewItem()})}};n.control=a,cc._RF.pop()},{"../all_modules":"all_modules"}],data:[function(e,t,n){"use strict";cc._RF.push(t,"204a3QPv8tLJqFKCLPw5/rm","data"),n.__esModule=!0,n.data=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a={init:function(){r.data.isUserReady=!0},saveData:function(e,t){window.FBInstant?FBInstant.player.setDataAsync(e).then(function(){t&&t()}):r.utils.setTimeout(function(){for(var n in e)try{localStorage.setItem(n,JSON.stringify(e[n]))}catch(r){_log(r)}t&&t()},500)},loadData:function(e,t){window.FBInstant?FBInstant.player.getDataAsync(e).then(function(e){t&&t(e)}):r.utils.setTimeout(function(){var n={};e.map(function(e){var t=localStorage.getItem(e);if(t)try{n[e]=JSON.parse(t)}catch(r){}}),t&&t(n)},500)},loadEntryPointData:function(){if(window.FBInstant){var e=FBInstant.getEntryPointData();e&&e.player_sent_id&&(r.user.playerIdShare=e.player_sent_id),r.user.entryPointData=e}}};n.data=a,cc._RF.pop()},{"../all_modules":"all_modules"}],free_button_comp:[function(e,t){"use strict";cc._RF.push(t,"86a713+CeRB7KYdjV9121Vr","free_button_comp");var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}cc.Class({extends:cc.Component,freeHandler:function(e){e.target.freeButtonHandlerFunc&&(e.target.freeButtonHandlerFunc(e.target),n.audio.playSoundClickButton())}}),cc._RF.pop()},{"../all_modules":"all_modules"}],fx:[function(e,t,n){"use strict";cc._RF.push(t,"370c2Sb71pHBrzftBqzpjmc","fx"),n.__esModule=!0,n.fx=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a={init:function(){r.fx.rotateForever(cc.find("Canvas/layer_challenge_friend/header/decor/lightFx"))},rotateForever:function(e){e.runAction(cc.repeatForever(cc.rotateBy(10,360)))},bubbleForever:function(e,t,n,r,o){void 0===t&&(t=.5),void 0===n&&(n=0),void 0===r&&(r=1),void 0===o&&(o=1.2);var a=e.orgScale||e.scale;e.orgScale||(e.orgScale=a),e.stopAllActions(),e.runAction(cc.repeatForever(cc.sequence(cc.delayTime(n),cc.scaleTo(t,a*o),cc.scaleTo(t,a*r),cc.scaleTo(t,a*o),cc.scaleTo(t,a*r))))},bubble:function(e,t,n,r,o,a){void 0===n&&(n=.5),void 0===r&&(r=0),void 0===o&&(o=1),void 0===a&&(a=1.2);var i=e.orgScale||e.scale;e.orgScale||(e.orgScale=i),e.stopAllActions(),e.runAction(cc.sequence(cc.delayTime(r),cc.scaleTo(n,i*a),cc.scaleTo(n,i*o),cc.scaleTo(n,i*a),cc.scaleTo(n,i*o),cc.callFunc(function(){t&&t()})))},fxScoreNormal:function(e,t,n,o,a){void 0===a&&(a=.3),a*=.8;var i=r.utils.copyNodeTo(cc.find("Canvas/sample_nodes/sample_scoring_shadow"),e.parent);r.utils.setGlobalPositionToNode(i,e),i.color=cc.color(r.configs.scoringShadowColors[n]),i.opacity=0,i.zIndex=-1,i.active=!0,i.runAction(cc.sequence(cc.fadeIn(a),cc.delayTime(2.2*a),cc.fadeOut(a),cc.callFunc(function(){i.removeFromParent(!0)})));var c=r.utils.getGlobalPosition(e);t.map(function(t){var n=cc.find("Canvas/play_area/map/Image_HexBlock_"+t),o=e==n,i=o?e.parent:cc.find("Canvas/play_area/fx_container"),l=r.utils.copyNodeTo(n,i);l.name="temporary_fx_node",o&&(l.zIndex=-1,l.opacity=200);var s=r.utils.global2LocalPosDiff(l,c.x,c.y);l.getChildByName("bg").active=!1,l.runAction(cc.sequence(cc.callFunc(function(){r.utils.setTimeout(function(){return r.audio.playSound("scoring_merge_dices")},140)}),cc.moveBy(a,s).easing(cc.easeIn(2)),cc.delayTime(2.5*a),cc.callFunc(function(){return l.removeFromParent(!0)}))),l.runAction(cc.sequence(cc.delayTime(.5*a),cc.fadeOut(3*a)))}),r.utils.setTimeout(function(){o&&o()},1e3*a)},fxScore777:function(e,t,n){var o=r.map.getCellPosNumberArrAroundCenter(t).filter(function(t){return!e.includes(t)});this.specialFxRemoveCellGroup(e,t,o,n,!0)},specialFxRemoveCellGroup:function(e,t,n,o,a){var i=.1+(a?.1:0),c=.25+i,l=cc.find("Canvas/play_area/fx_container"),s=cc.find("Canvas/sample_nodes/sample_block_stroke"),u=cc.find("Canvas/sample_nodes/sample_block_white"),d=cc.find("Canvas/sample_nodes/sample_fx_white_bg"),f=cc.find("Canvas/play_area/map/Image_HexBlock_"+t);r.utils.setTimeout(function(){return o&&o()},1e3*(.2+c+.3+.5+.1));var p=function(e){return cc.find("Canvas/play_area/map/Image_HexBlock_"+e)};r.map.getCellPosNumberArrAroundCenter(t).map(function(e){var t=p(e),n=r.utils.copyNodeTo(d,t);r.utils.setTimeout(function(){n.runAction(cc.fadeIn(.3))},1e3*(.2+c+(a?.3:0))),r.utils.setTimeout(function(){n.runAction(cc.sequence(cc.fadeOut(.5),cc.callFunc(function(){n.removeFromParent(!0)})))},1e3*(.2+c+.3+.5))});var g=function(e,t){var n=r.utils.copyNodeTo(e,l);return n.zIndex=t,r.utils.getChildByPath(n,"sample_block/blockShadow").active=!1,n.getChildByName("sample_block").active=!0,n},m=function(e,t,n){r.utils.copyNodeTo(u,e).runAction(cc.sequence(cc.delayTime(.2+c+n),cc.callFunc(function(){t&&t.runAction(cc.fadeOut(.3)),r.utils.getChildByPath(e,"sample_block/block_img").runAction(cc.sequence(cc.delayTime(.15),cc.fadeOut(.15)))}),cc.fadeIn(.3)))},h=function(e){e.runAction(cc.sequence(cc.delayTime(.2+c+.3+(a?.3:0)),cc.spawn(cc.fadeOut(.5),cc.scaleTo(.5,0),cc.rotateBy(.5,180)),cc.callFunc(function(){e.removeFromParent(!0)})))};n&&n.map(function(e){var t=p(e);if(t.getChildByName("sample_block").active=!1,r.map.currentState[e]){var n=g(t,e);m(n,null,a?.3:0),h(n)}}),e.map(function(e){var t=p(e);if(t.getChildByName("sample_block").active=!1,r.map.currentState[e]){var n=g(t,e),o=t==f,c=r.utils.copyNodeTo(s,n);if(c.opacity=0,c.runAction(cc.fadeIn(.2)),!o){var l=t.position.sub(f.position);n.runAction(cc.sequence(cc.delayTime(.2),cc.moveBy(.25,l.mul(.3)),cc.callFunc(function(){r.utils.setTimeout(function(){return r.audio.playSound("scoring_merge_dices")},i/2*1e3)}),cc.moveBy(i,l.mul(-.3-(a?1:0)))))}m(n,c,!a&&o?-.3:0),h(n)}})},fxNewScoredBlock:function(e,t,n,o){var a=cc.find("Canvas/play_area/fx_container"),i=r.utils.copyNodeTo(e,a);r.utils.setGlobalPositionToNode(i,e),i.y+=100,i.scale=1.4,i.opacity=0,i.active=!0,i.runAction(cc.sequence(cc.delayTime(o),cc.spawn(cc.fadeIn(.072),cc.moveBy(.144,cc.v2(0,-90)),cc.scaleTo(.144,1.05)),cc.callFunc(function(){r.audio.playSound("new_item_2"),r.fx.diceShakingFx(i,t,function(){i.active=!1,i.removeFromParent(!0),e.y+=10,e.scale=1.05,e.active=!0,e.opacity=255,e.runAction(cc.spawn(cc.scaleTo(.016,1),cc.moveTo(.016,cc.v2(0,0)),cc.callFunc(function(){return setTimeout(function(){return n&&n()},100)})))})})))},diceShakingFx:function(e,t,n){var o=e.getChildByName("block_img").getComponent(cc.Sprite),a=cc.find("Canvas").getComponent("canvas_init").diceShakingFxSprite.slice(3*(t-1),3*t);(a=[a[1],a[0],a[2]]).map(function(e,t){r.utils.setTimeout(function(){o.spriteFrame=e},80*t)}),r.utils.setTimeout(function(){return n&&n()},80*a.length)},newBlockDropDown:function(e,t,n,o){var a=cc.find("Canvas").getComponent("canvas_init").diceShakingFxSprite.slice(3*(t-1),3*t);e.getChildByName("block_img").getComponent(cc.Sprite).spriteFrame=a[1],e.active=!1;var i=cc.find("Canvas/play_area/fx_container"),c=r.utils.copyNodeTo(e,i);r.utils.setGlobalPositionToNode(c,e),c.y+=120,c.scale=1.4,c.opacity=0,c.active=!0,r.audio.playSound("new_item_1"),c.runAction(cc.sequence(cc.delayTime(o),cc.spawn(cc.fadeIn(.072),cc.moveBy(.144,cc.v2(0,-120)),cc.scaleTo(.144,1)),cc.callFunc(function(){r.audio.playSound("new_item_2"),r.fx.newItemDiceShakingFx(c,t,function(){e.getChildByName("block_img").getComponent(cc.Sprite).spriteFrame=a[0],c.active=!1,c.removeFromParent(!0),e.active=!0,n&&n()})})))},newItemDiceShakingFx:function(e,t,n){var o=e.getChildByName("block_img").getComponent(cc.Sprite),a=cc.find("Canvas").getComponent("canvas_init").diceShakingFxSprite.slice(3*(t-1),3*t);(a=[a[0],a[2],a[0],a[1],a[0]]).map(function(e,t){r.utils.setTimeout(function(){o.spriteFrame=e},60*t)}),r.utils.setTimeout(function(){return n&&n()},60*a.length)},freeToolTipNodeArr:[],showScoreToolTip:function(e,t,n,o,a,i,c,l){var s=this;void 0===n&&(n=60),void 0===a&&(a=100),void 0===i&&(i=1.6),void 0===c&&(c=.2),void 0===l&&(l=0);var u=cc.find("Canvas/play_area/fx_container/sample_score_tool_tip"),d=this.freeToolTipNodeArr.pop()||r.utils.copyNodeTo(u,cc.find("Canvas/play_area/fx_container"));r.utils.setLabelText(d,e),r.utils.setGlobalPositionToNode(d,t),d.y+=n,d.active=!0,d.zIndex=999,d.opacity=0,d.runAction(cc.sequence(cc.fadeIn(c),cc.delayTime(l),cc.spawn(cc.moveBy(i,cc.v2(0,a)),cc.fadeOut(i)),cc.callFunc(function(){d.active=!1,s.freeToolTipNodeArr.push(d),o&&o()})))},freeFlyScoreNodeArr:[],singleScoreLabelFly:function(e,t,n){var o=this;void 0===n&&(n=.3);var a=cc.find("Canvas/play_area/fx_container/sample_label_fly_score"),i=this.freeFlyScoreNodeArr.pop()||r.utils.copyNodeTo(a,cc.find("Canvas/play_area/fx_container"));r.utils.setLabelText(i,t),r.utils.setGlobalPositionToNode(i,e);var c=cc.find("Canvas/play_area/pause_button_bg/label_score"),l=r.utils.getGlobalPosition(c);i.active=!0,i.zIndex=999;var s=r.utils.global2LocalPosDiff(i,l.x,l.y);i.runAction(cc.sequence(cc.moveBy(n,s).easing(cc.easeIn(1.4)),cc.callFunc(function(){i.active=!1,o.freeFlyScoreNodeArr.push(i)})))},multiScoreLabelFly7:function(e,t,n){var o=this,a="+"+r.utils.localizeNumber(parseInt(t/e.length));e.map(function(e,t){var n=cc.find("Canvas/play_area/map/Image_HexBlock_"+e);r.utils.setTimeout(function(){o.singleScoreLabelFly(n,a)},70*t)}),r.utils.setTimeout(function(){return n&&n()},70*e.length)},multiScoreLabelFlyNormal:function(e,t,n,o){var a=this,i="+"+r.utils.localizeNumber(parseInt(n/t.length));t.map(function(t,n){r.utils.setTimeout(function(){a.singleScoreLabelFly(e,i)},70*n)}),r.utils.setTimeout(function(){return o&&o()},70*t.length)}};n.fx=a,cc._RF.pop()},{"../all_modules":"all_modules"}],game_flow:[function(e,t,n){"use strict";cc._RF.push(t,"aa682mqxVxOd5xRHTkSL9es","game_flow"),n.__esModule=!0,n.gameFlow=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a={videoContinueLeft:0,gameStartTime:0,cellsToRemoveAfterVideo:[7,8,9,12,13,14,17,18,19],centerCellNumber:13,init:function(){},pause:function(){r.game.stopPhysic(),r.game.stopUpdateRealHeight()},resume:function(){r.game.startPhysic(),r.game.startUpdateRealHeight()},handleGameOver:function(){_log(" this.realGameOver() "),this.realGameOver()},onVideoContinueSuccess:function(){_log(" onVideoContinueSuccess called !!! ")},removeLastKeyBlockGroup:function(){},onVideoContinueFail:function(){},realGameOver:function(e){void 0===e&&(e=!1),_log(" realGameOver _G.user.bestScore = ",r.user.bestScore,"_G.user.score=",r.user.score),(r.user.bestScore||0)<r.user.score&&(r.user.bestScore=r.user.score,r.data.saveData({bestScore:r.user.bestScore})),r.game.stopPhysic(),e||this.visualGameOver()},visualGameOver:function(){r.ui.showLayer("layer_game_over")},replay:function(){r.map.resetMap(),r.game.reset(),r.game.startPhysic(),r.game.startUpdateRealHeight(),r.game.genNewItem()},check2LogTimeToGameOver:function(e){void 0===e&&(e=!1)}};n.gameFlow=a,cc._RF.pop()},{"../all_modules":"all_modules"}],game:[function(e,t,n){"use strict";cc._RF.push(t,"6b006P+TPhOeo6Ufy6Luxy2","game"),n.__esModule=!0,n.game=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a={currentItemNode:null,currentKeyBlockNumber:0,stepCount:0,currentHeight:0,currentRealHeight:0,baseY:0,newBlockPosDiff:700,numberOfLastBlockToSave:10,lastBlockArr:[],cameraToScreenFixRatio:.35,cameraTopTowerY:0,freeBlocks:{letter_L:[],letter_Z:[],letter_Z1:[],letter_T:[],square:[],stick:[]},lifeCount:3,currentNewBlock:null,normalFallingSpeed:100,fastFallingSpeed:500,gravityScale:.8,init:function(){var e=this;r.game.startPhysic(),setTimeout(function(){return r.game.stopPhysic()});var t=cc.find("Canvas/play_area/map_base"),n=cc.find("Canvas/play_area/alert_line"),o=cc.find("Canvas/play_area/drop_line");r.utils.setOrgPos(n),r.utils.setOrgPos(o),this.baseY=t.y+t.height/2-n.y+n.height/2,this.cameraTopTowerY=cc.winSize.height*this.cameraToScreenFixRatio,r.login.addLoginDataField("lastNewItem"),r.login.addLoginDataField("stepCount"),r.login.addLoginDataField("videoContinueLeft"),r.login.addLoginDataField("lastScore"),r.login.addLoginDataField("bestScore"),r.login.addLoginDataField("currentMapState"),r.login.addLoginDataField("isAskingVideoContinue"),r.login.addCallback(function(t){r.user.score=t.lastScore||0,r.user.bestScore=t.bestScore||0,r.ui.updateScore(),e.stepCount=t.stepCount||0,e.videoContinueLeft=t.videoContinueLeft||r.configs.videoContinueTime,t.isAskingVideoContinue?(r.data.saveData({isAskingVideoContinue:!1}),r.gameFlow.replay()):setTimeout(function(){t.lastNewItem},500)})},updateScore:function(){var e=r.user.score=parseInt(.4*r.game.currentHeight);r.ui.updateScore(e)},reset:function(){r.game.currentHeight=r.game.currentRealHeight=this.baseY,r.game.adjustBottomLines(),r.game.updateScore(),cc.find("Canvas/play_camera").y=0,this.lastBlockArr=[],this.lifeCount=3,this.renderLifeCount()},startPhysic:function(){cc.director.getPhysicsManager().enabled=!0,cc.director.getPhysicsManager().gravity=cc.v2(0,-140)},stopPhysic:function(){cc.director.getPhysicsManager().enabled=!1},genNewItem:function(){var e=r.utils.randomArrItem(["letter_Z","letter_Z1","letter_L","letter_T","square","stick"]),t=this.currentNewBlock=this.newItem(e);this.updateHighlight(),this.lastBlockArr.unshift(t),this.lastBlockArr.length>this.numberOfLastBlockToSave&&this.lastBlockArr.pop()},newItem:function(e){void 0===e&&(e="square");var t=cc.find("Canvas/play_area/map"),n=cc.find("Canvas/play_area/sample_blocks/"+e),o=this.freeBlocks[e].pop();!o||o.parent?(o=r.utils.copyNodeTo(n,t)).orgName=o.name:t.addChild(o);var a=o.getComponent(cc.RigidBody);a.gravityScale=0,a.linearVelocity=cc.v2(0,-this.normalFallingSpeed),a.angularVelocity=0,a.awake=!1;var i=cc.v2(0,_max(this.currentRealHeight,this.cameraTopTowerY)+this.newBlockPosDiff);return o.position=i,o.angle=0,o.active=!0,o.isFreeNode=!1,o},itemRemove:function(e,t,n){var o=this;e.active=!1,e.removeFromParent(!0),e.isFreeNode=!0,setTimeout(function(){return o.freeBlocks[e.orgName].unshift(e)},400),t?e.name=e.orgName:(this.lifeCount--,this.renderLifeCount(),this.lifeCount<=0?r.gameFlow.handleGameOver():n&&this.genNewItem())},renderLifeCount:function(){var e=this;cc.find("Canvas/play_area/lives_left").children.map(function(t,n){t.active=n<e.lifeCount})},updateHighlight:function(){if(this.currentNewBlock){var e=cc.find("Canvas/play_area/block_hightlight"),t=this.currentNewBlock.getBoundingBox();e.x=t.x+t.width/2,e.width=t.width}},slowDownNewItem:function(){this.currentNewBlock&&(this.currentNewBlock.getComponent(cc.RigidBody).linearVelocity=cc.v2(0,-this.normalFallingSpeed))},speedUpNewItem:function(){this.currentNewBlock&&(this.currentNewBlock.getComponent(cc.RigidBody).linearVelocity=cc.v2(0,-this.fastFallingSpeed))},moveNewItem:function(e){var t=this;if(this.currentNewBlock){var n=21.5*{left:-1,right:1}[e];this.currentNewBlock.runAction(cc.sequence(cc.moveBy(.01,cc.v2(n,0)),cc.callFunc(function(){return t.updateHighlight()})))}},rotateNewItem:function(){var e=this;this.currentNewBlock&&this.currentNewBlock.runAction(cc.sequence(cc.rotateBy(.01,90),cc.callFunc(function(){return e.updateHighlight()})))},onBlockTouchBase:function(e){e.getComponent(cc.RigidBody).gravityScale=this.gravityScale,this.genNewItem(),this.updateRealHeight(!0)},updateRealHeight:function(e){var t=this.getRealHeight();t>r.game.currentHeight&&(r.game.currentHeight,r.game.currentHeight=t,e&&r.game.updateScore(r.game.currentHeight)),this.adjustCamera(t),this.adjustBottomLines(),this.currentRealHeight=t},startUpdateRealHeight:function(){var e=this;this.realHeightUpdateTimer=setInterval(function(){return e.updateRealHeight()},500)},stopUpdateRealHeight:function(){this.realHeightUpdateTimer&&clearInterval(this.realHeightUpdateTimer)},getRealHeight:function(){var e=this.baseY;return this.lastBlockArr.map(function(t){if("map_base"==t.name){var n=t.getBoundingBox().yMax;e=_max(e,n)}}),e},adjustBottomLines:function(){var e=cc.find("Canvas/play_area/alert_line"),t=e.orgPos.y+this.currentRealHeight-this.cameraTopTowerY;t<=e.orgPos.y&&(t=e.orgPos.y),e.runAction(cc.moveTo(.01,cc.v2(0,t)));var n=cc.find("Canvas/play_area/drop_line"),r=n.orgPos.y+this.currentRealHeight-this.cameraTopTowerY;r<=n.orgPos.y&&(r=n.orgPos.y),n.runAction(cc.moveTo(.01,cc.v2(0,r)))},adjustCamera:function(e){var t=e-this.cameraTopTowerY;t<=0&&(t=0);var n=cc.find("Canvas/play_camera"),r=_abs(t-n.y)/150;r=_min(r,.4),n.stopAllActions(),n.runAction(cc.moveTo(r,cc.v2(0,t)))},handleBlockScoring:function(){},score:function(){}};n.game=a,cc._RF.pop()},{"../all_modules":"all_modules"}],get7Video:[function(e,t,n){"use strict";cc._RF.push(t,"119acPApGdODrla0aCbW82K","get7Video"),n.__esModule=!0,n.get7Video=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a={block7Left:0,init:function(){var e=this;r.login.addLoginDataField("block7Left"),r.login.addCallback(function(t){e.block7Left=t.block7Left||(t.isNewUser?r.configs.freeBlock7ForNewUser:0),e.updateButton(),t.isNewUser&&r.data.saveData({block7Left:r.configs.freeBlock7ForNewUser})})},btnClick:function(){this.block7Left?this.use7():this.get7()},use7:function(){7!=r.game.currentKeyBlockNumber&&(r.game.genItemBlock7(),this.block7Left--,r.data.saveData({block7Left:this.block7Left}),this.updateButton())},get7:function(){var e=this;r.video.showVideo(function(){e.block7Left=r.configs.block7EachVideo,e.updateButton(),r.data.saveData({block7Left:e.block7Left})},function(e){r.ui.showAlert("somethingWrong"),console.log(e)},"get_block_7")},updateButton:function(){var e=cc.find("Canvas/play_area/botBar/get_block_7/badge/block7_left");e.active=this.block7Left,r.utils.setLabelText(e,this.block7Left+""),cc.find("Canvas/play_area/botBar/get_block_7/block7").opacity=this.block7Left?255:128,cc.find("Canvas/play_area/botBar/get_block_7/badge/video").active=!this.block7Left}};n.get7Video=a,cc._RF.pop()},{"../all_modules":"all_modules"}],inter_ad:[function(e,t,n){"use strict";cc._RF.push(t,"fcbfbljkFhMgZXyELxeCTA9","inter_ad"),n.__esModule=!0,n.interAd=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a={init:function(){this.preloadInterAds()},interAdObj:null,preloadInterAds:function(){var e=this;window.FBInstant&&(_log(" preloadInterAds 1111 "),this.interAdObj=null,FBInstant.getInterstitialAdAsync(r.configs.interAdId).then(function(t){t.loadAsync().then(function(){e.interAdObj=t}).catch(function(e){return console.warn(e)})}).catch(function(e){return console.warn(e)}))},showInterAds:function(e,t){var n=this;if(console.log(" showInterAds 1111 "),!window.FBInstant||!this.interAdObj)return t&&t();this.interAdObj.showAsync().then(function(){r.interAd.log(e,1),t&&t(),n.preloadInterAds()}).catch(function(n){console.warn(n),r.interAd.log(e,0,n.code),t&&t()})},log:function(e,t,n){void 0===n&&(n=""),r.utilsFB.log("ev_inter_ad",1,{position:e,watched_success:t,err_code:n}),t&&(r.utilsFB.log("Ads-Total-Inter"),r.utilsFB.log("Ads-Total"))},replayCount2ShowAd:0,checkToShowReplayAd:function(){this.replayCount2ShowAd++,this.replayCount2ShowAd%r.configs.showInterAdAfterEveryReplayTime==1&&this.showInterAds("gameOverReplay")}};n.interAd=a,cc._RF.pop()},{"../all_modules":"all_modules"}],leaderboard:[function(e,t,n){"use strict";cc._RF.push(t,"13592UeQb9KNqFELQ4Jpn98","leaderboard"),n.__esModule=!0,n.leaderboard=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a={leaderboard:null,globalPlayerArr:[],isEntriesLoadedGlobal:!1,friendsPlayerArr:[],isEntriesLoadedFriends:!1,init:function(){this.reloadAndRender(),r.login.addLoginDataField("bestScore"),r.login.addCallback(function(e){r.user.bestScore=e.bestScore||0,r.ui.updateScore(),_log(" leaderboard.init() >> _G.user.bestScore="+r.user.bestScore)})},adjustHeight:function(e){_log(" cc.winSize.height = "+cc.winSize.height+" ");var t=cc.winSize.height-530-(e?160:0);_log(" height = "+t+" "),cc.find("Canvas/layer_leaderboard/content_bg/middle_container/leaderboard/leaderboard_content").height=t},reloadAndRender:function(){var e=this;if(window.FBInstant){var t=this;FBInstant.getLeaderboardAsync(r.configs.leaderboardName).then(function(e){t.leaderboard=e,t.leaderboard.getPlayerEntryAsync().then(function(e){e?t.getEntries():t.leaderboard.setScoreAsync(0,"").then(function(){t.getEntries()})})}).catch(function(e){return _log(" error getting leaderboard ",e)})}else this.globalPlayerArr=[{id:"xxxxaa111x",name:"Global 123",score:222},{id:"xxxxaa111x",name:"Global 456",score:676},{id:"xxxxaa111",name:"Global",score:1235},{id:"xxxxaa111x",name:"Global 789",score:4354},{id:"xxxxaa111x",name:"Global 100",score:3455},{id:"xxxxaa111x",name:"Global 456",score:676},{id:"xxxxaa111",name:"Global",score:1235},{id:"xxxxaa111x",name:"Global 789",score:4354},{id:"xxxxaa111x",name:"Global 100",score:3455},{id:"xxxxaa111x",name:"Global 456",score:676},{id:"xxxxaa111",name:"Global",score:1235},{id:"xxxxaa111x",name:"Global 789",score:4354},{id:"xxxxaa111x",name:"Global 100",score:3455}],r.leaderboard.isEntriesLoadedGlobal=!0,this.friendsPlayerArr=[{id:"xxxxaa111",photo:"https://developer.mozilla.org/static/img/opengraph-logo.72382e605ce3.png",name:"Friend 123",score:222},{id:"xxxxaa2",photo:"https://developer.mozilla.org/static/img/opengraph-logo.72382e605ce3.png",name:"Friend 456",score:676}],r.user.bestScore=12,r.ui.updateScore(),r.leaderboard.isEntriesLoadedFriends=!0;r.utils.waitToRun(function(){return e.render("friends")},"isEntriesLoadedFriends",r.leaderboard)},getEntries:function(){var e=this;this.leaderboard.getConnectedPlayerEntriesAsync(r.configs.leaderboardPlayerCount,0).then(function(t){e.friendsPlayerArr=e.entriesToArr(t)||[],r.leaderboard.isEntriesLoadedFriends=!0}).catch(function(e){return _log("Error getting leaderboard global entries ",e)})},entriesToArr:function(e){for(var t=[],n=0;n<e.length;n++){var o=e[n],a={id:o.getPlayer().getID(),photo:o.getPlayer().getPhoto(),name:o.getPlayer().getName(),score:o.getScore(),rank:o.getRank()};t.push(a),a.id==r.user.id&&(r.user.bestScore=a.score||r.user.bestScore,_log(" leaderboard.entriesToArr() >> _G.user.bestScore="+r.user.bestScore+" // player.score="+a.score+" "),r.ui.updateScore())}return t},saveScore:function(){this.leaderboard&&(r.ui.showNagScreen(),this.leaderboard.setScoreAsync(r.user.score,"").then(function(){_log("saveScore :: >>> saved score to leaderboard-- - _G.user.score = "+r.user.score+" "),_log("_G.user.bestScore = ",r.user.bestScore,"_G.user.score = ",r.user.score),r.user.bestScore<=r.user.score&&(_log("_G.user.bestScore < _G.user.score "),r.leaderboard.isEntriesLoadedFriends=!1,r.leaderboard.isEntriesLoadedGlobal=!1,r.leaderboard.reloadAndRender()),r.social.playerIdSendMessage&&r.social.sendMessageAfterQuit(),r.ui.hideNagScreen()}).catch(function(e){return _log("saveScore err ",e)}))},render:function(e){void 0===e&&(e="friends");var t=r.leaderboard[e+"PlayerArr"],n=cc.find("Canvas/layer_leaderboard/content_bg/middle_container/leaderboard/leaderboard_content/sample_row"),o=cc.find("Canvas/layer_leaderboard/content_bg/middle_container/leaderboard/leaderboard_content/scrollview_"+e+"/view/content");o.removeAllChildren();var a="friends"==e;t.map(function(e,t){var i=r.utils.copyNodeTo(n,o);i.active=!0,i.getChildByName("bg2").active=t%2;for(var c=0;c<3;c++)r.utils.getChildByPath(i,"avatar/LeaderBoardStrokeAvatar_"+(c+1)).active=c==t;e.photo&&cc.assetManager.loadRemote(e.photo,function(e,t){if(e)return _log(e);r.utils.getChildByPath(i,"avatar/real_avatar").getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t)}),r.utils.setLabelText(i.getChildByName("label_rank"),t+1+"."),r.utils.setLabelText(i.getChildByName("label_user_name"),e.name);var l=i.getChildByName("label_score");r.utils.setLabelText(l,r.utils.localizeNumber(e.score)),l.x=a?62:210,i.getChildByName("btn_brag").active=a&&e.id==r.user.id,i.getChildByName("btn_play").active=a,r.utils.addButtonComp(i.getChildByName("btn_brag"),function(){r.utilsFB.log("ev_click_button_share_in_leader_board",1,{Position:t}),r.social.share(e.score)}),r.utils.addButtonComp(i.getChildByName("btn_play"),function(){r.utilsFB.log("ev_click_button_play_in_leader_board",1,{Position:t}),r.social.createContext(e.id,function(){r.social.playerIdSendMessage=e.id,r.ui.hideLayer("layer_leaderboard"),r.gameFlow.replay()})})})},currentTabName:"friends",onClickTab:function(e){e!=this.currentTabName&&(this.currentTabName=e,["global","friends"].map(function(t){return n=t,r=t==e,cc.find("Canvas/layer_leaderboard/content_bg/middle_container/leaderboard/tabs/"+n+"/active").active=r,void(cc.find("Canvas/layer_leaderboard/content_bg/middle_container/leaderboard/leaderboard_content/scrollview_"+n).active=r);var n,r}))},updateScoreLabel:function(){r.utils.setLabelText(cc.find("Canvas/layer_leaderboard/header/label_score"),r.utils.localizeNumber(r.user.score))}};n.leaderboard=a,cc._RF.pop()},{"../all_modules":"all_modules"}],load_optimize:[function(e,t,n){"use strict";cc._RF.push(t,"92ffa13eQpNpY7rLxzNKOJI","load_optimize"),n.__esModule=!0,n.loadOptimize=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a={init:function(){setTimeout(function(){return r.loadOptimize.initReal()},1e3)},initReal:function(){var e=cc.find("Canvas/play_area/btn_pause"),t=e.getComponent(cc.Sprite).spriteFrame;e.opacity=0,e.active=!0,["Canvas/messages","Canvas/shares","Canvas/bg/full_bg","Canvas/play_area/btn_pause","Canvas/play_area/botBar/get_block_7","Canvas/play_area/botBar/remove_new_item"].map(function(e){var n=cc.find(e);n.opacity=0,r.utils.waitToRun(function(){n.active=!0,n.runAction(cc.fadeIn(.5))},"textureLoaded()",t)})}};n.loadOptimize=a,cc._RF.pop()},{"../all_modules":"all_modules"}],login:[function(e,t,n){"use strict";cc._RF.push(t,"692aajT6PVNgLZ8+a5hX7Q2","login"),n.__esModule=!0,n.login=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a=["LoginTime","IsOldUser","isTutDone"],i=[],c={init:function(){r.utils.waitToRun(function(){r.data.loadEntryPointData(),r.login.getFBData()},"isUserReady",r.data)},addLoginDataField:function(e){a.includes(e)||a.push(e)},addCallback:function(e){r.login.loginData?e(r.login.loginData):i.push(e)},getFBData:function(){r.data.loadData(a,function(e){if(e.isNewUser=!e.IsOldUser,e.isNewUser)return r.utilsFB.log("ev_login_new_user_incoming"),r.user.initNewUser(e),r.login.initLogin(e),void r.data.saveData({IsOldUser:!0});r.login.initLogin(e)})},initLogin:function(e){r.login.isInitLoginCalled||(r.login.isInitLoginCalled=!0,r.login.loginData=e,r.user.lastLoginTime=e.LoginTime||_time(),i.map(function(t){try{t(e)}catch(n){_log("loginCallback func error",n)}}))}};n.login=c,cc._RF.pop()},{"../all_modules":"all_modules"}],map_visual:[function(e,t,n){"use strict";function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}cc._RF.push(t,"dfa94skyI1Pxqqq27McwCVs","map_visual"),n.__esModule=!0,n.mapVisual=void 0,function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}n.default=e,t&&t.set(e,n)}(e("../all_modules")),n.mapVisual={blockSFrameArr:[],init:function(){},resetSingleCell:function(){},resetMap:function(){},decorBlock:function(e,t,n,r,o){void 0===o&&(o=0)},renderSingleCell:function(){},renderMap:function(){}},cc._RF.pop()},{"../all_modules":"all_modules"}],map:[function(e,t,n){"use strict";cc._RF.push(t,"6e8560gSa5B1rLT9gozGXOQ","map"),n.__esModule=!0,n.map=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a={cellLinkMap:{},currentState:null,selectedCell:null,minorCell:null,oppositeLinkName:{left:"right",top:"bottom"},init:function(){},resetMap:function(){cc.find("Canvas/play_area/map").children.slice(0).map(function(e){return r.game.itemRemove(e,!0)})},setSingleCell:function(){},clearSingleCell:function(){},setCellGroup:function(){},clearCellGroup:function(){},checkNewItemDroppableAtCell:function(){},dropNewItemAtCell:function(){},checkAvailableNewItemInfo:function(){},isFulled:function(){},checkBlockScore:function(){}};n.map=a,cc._RF.pop()},{"../all_modules":"all_modules"}],md5:[function(e,t){"use strict";cc._RF.push(t,"b73f2W5pvZN5KMni9OHtD3c","md5"),t.exports={MD5:function(e){function t(e,t){return e<<t|e>>>32-t}function n(e,t){var n,r,o,a,i;return o=2147483648&e,a=2147483648&t,i=(1073741823&e)+(1073741823&t),(n=1073741824&e)&(r=1073741824&t)?2147483648^i^o^a:n|r?1073741824&i?3221225472^i^o^a:1073741824^i^o^a:i^o^a}function r(e,t,n){return e&t|~e&n}function o(e,t,n){return e&n|t&~n}function a(e,t,n){return e^t^n}function i(e,t,n){return t^(e|~n)}function c(e,o,a,i,c,l,s){return e=n(e,n(n(r(o,a,i),c),s)),n(t(e,l),o)}function l(e,r,a,i,c,l,s){return e=n(e,n(n(o(r,a,i),c),s)),n(t(e,l),r)}function s(e,r,o,i,c,l,s){return e=n(e,n(n(a(r,o,i),c),s)),n(t(e,l),r)}function u(e,r,o,a,c,l,s){return e=n(e,n(n(i(r,o,a),c),s)),n(t(e,l),r)}function d(e){var t,n="",r="";for(t=0;t<=3;t++)n+=(r="0"+(e>>>8*t&255).toString(16)).substr(r.length-2,2);return n}var f,p,g,m,h,_,v,y,b,w=Array();for(w=function(e){for(var t,n=e.length,r=n+8,o=16*((r-r%64)/64+1),a=Array(o-1),i=0,c=0;c<n;)i=c%4*8,a[t=(c-c%4)/4]=a[t]|e.charCodeAt(c)<<i,c++;return i=c%4*8,a[t=(c-c%4)/4]=a[t]|128<<i,a[o-2]=n<<3,a[o-1]=n>>>29,a}(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t}(e)),_=1732584193,v=4023233417,y=2562383102,b=271733878,f=0;f<w.length;f+=16)p=_,g=v,m=y,h=b,_=c(_,v,y,b,w[f+0],7,3614090360),b=c(b,_,v,y,w[f+1],12,3905402710),y=c(y,b,_,v,w[f+2],17,606105819),v=c(v,y,b,_,w[f+3],22,3250441966),_=c(_,v,y,b,w[f+4],7,4118548399),b=c(b,_,v,y,w[f+5],12,1200080426),y=c(y,b,_,v,w[f+6],17,2821735955),v=c(v,y,b,_,w[f+7],22,4249261313),_=c(_,v,y,b,w[f+8],7,1770035416),b=c(b,_,v,y,w[f+9],12,2336552879),y=c(y,b,_,v,w[f+10],17,4294925233),v=c(v,y,b,_,w[f+11],22,2304563134),_=c(_,v,y,b,w[f+12],7,1804603682),b=c(b,_,v,y,w[f+13],12,4254626195),y=c(y,b,_,v,w[f+14],17,2792965006),_=l(_,v=c(v,y,b,_,w[f+15],22,1236535329),y,b,w[f+1],5,4129170786),b=l(b,_,v,y,w[f+6],9,3225465664),y=l(y,b,_,v,w[f+11],14,643717713),v=l(v,y,b,_,w[f+0],20,3921069994),_=l(_,v,y,b,w[f+5],5,3593408605),b=l(b,_,v,y,w[f+10],9,38016083),y=l(y,b,_,v,w[f+15],14,3634488961),v=l(v,y,b,_,w[f+4],20,3889429448),_=l(_,v,y,b,w[f+9],5,568446438),b=l(b,_,v,y,w[f+14],9,3275163606),y=l(y,b,_,v,w[f+3],14,4107603335),v=l(v,y,b,_,w[f+8],20,1163531501),_=l(_,v,y,b,w[f+13],5,2850285829),b=l(b,_,v,y,w[f+2],9,4243563512),y=l(y,b,_,v,w[f+7],14,1735328473),_=s(_,v=l(v,y,b,_,w[f+12],20,2368359562),y,b,w[f+5],4,4294588738),b=s(b,_,v,y,w[f+8],11,2272392833),y=s(y,b,_,v,w[f+11],16,1839030562),v=s(v,y,b,_,w[f+14],23,4259657740),_=s(_,v,y,b,w[f+1],4,2763975236),b=s(b,_,v,y,w[f+4],11,1272893353),y=s(y,b,_,v,w[f+7],16,4139469664),v=s(v,y,b,_,w[f+10],23,3200236656),_=s(_,v,y,b,w[f+13],4,681279174),b=s(b,_,v,y,w[f+0],11,3936430074),y=s(y,b,_,v,w[f+3],16,3572445317),v=s(v,y,b,_,w[f+6],23,76029189),_=s(_,v,y,b,w[f+9],4,3654602809),b=s(b,_,v,y,w[f+12],11,3873151461),y=s(y,b,_,v,w[f+15],16,530742520),_=u(_,v=s(v,y,b,_,w[f+2],23,3299628645),y,b,w[f+0],6,4096336452),b=u(b,_,v,y,w[f+7],10,1126891415),y=u(y,b,_,v,w[f+14],15,2878612391),v=u(v,y,b,_,w[f+5],21,4237533241),_=u(_,v,y,b,w[f+12],6,1700485571),b=u(b,_,v,y,w[f+3],10,2399980690),y=u(y,b,_,v,w[f+10],15,4293915773),v=u(v,y,b,_,w[f+1],21,2240044497),_=u(_,v,y,b,w[f+8],6,1873313359),b=u(b,_,v,y,w[f+15],10,4264355552),y=u(y,b,_,v,w[f+6],15,2734768916),v=u(v,y,b,_,w[f+13],21,1309151649),_=u(_,v,y,b,w[f+4],6,4149444226),b=u(b,_,v,y,w[f+11],10,3174756917),y=u(y,b,_,v,w[f+2],15,718787259),v=u(v,y,b,_,w[f+9],21,3951481745),_=n(_,p),v=n(v,g),y=n(y,m),b=n(b,h);return(d(_)+d(v)+d(y)+d(b)).toLowerCase()}},cc._RF.pop()},{}],message:[function(e,t,n){"use strict";cc._RF.push(t,"e3782nfm/NO1ZCTDPlA4iLf","message");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{l(r.next(e))}catch(t){a(t)}}function c(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}l((r=r.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(e){return function(t){return l([e,t])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(c){a=[6,c],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var l=e("../all_modules"),s=cc._decorator,u=s.ccclass,d=s.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Play_with_message=null,t}return o(t,e),t.prototype.onLoad=function(){var e=l.utils.getChildByPath(this.Play_with_message,"avata");e.avarNodeOrgSize={},e.avarNodeOrgSize.width=e.width,e.avarNodeOrgSize.height=e.height},t.prototype.initBase64Picture=function(e){return i(this,void 0,void 0,function(){var t,n,r,o,a,i,l,s,u,d,f,p,g,m;return c(this,function(){for(e.activeInHierarchy||(e.parent.active=!0,e.parent.parent.active=!0),t=new cc.Node,e.addChild(t),t.position=e.position,(n=t.addComponent(cc.Camera)).cullingMask=4294967295,(r=new cc.RenderTexture).initWithSize(e.width,e.height),n.targetTexture=r,n.zoomRatio=3.27,o=r.width,a=r.height,(i=document.createElement("canvas")).width=o,i.height=a,l=i.getContext("2d"),n.render(e),s=r.readPixels(),u=4*o,d=0;d<a;d++)f=a-1-d,p=new Uint8ClampedArray(s.buffer,f*o*4,u),g=new ImageData(p,o,1),l.putImageData(g,0,d);return m=i.toDataURL(),setTimeout(function(){return e.parent.active=!1},2e3),[2,m]})})},t.prototype.initPayload=function(e,t,n,r){return i(this,void 0,void 0,function(){var o;return c(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.initBase64Picture(e)];case 1:return o=a.sent(),[2,{action:"CUSTOM",text:l.language.generateMsgTextObject(t),cta:l.language.generateMsgTextObject(n),image:o,template:"play_turn",strategy:"IMMEDIATE",data:r,notification:"PUSH"}];case 2:throw a.sent();case 3:return[2]}})})},t.prototype.sendMessageScore=function(){return i(this,void 0,void 0,function(){var e,t,n,r,o,a;return c(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),(e=l.utils.getChildByPath(this.Play_with_message,"avata")).getComponent(cc.Sprite).spriteFrame=l.user.avatarSpriteFrame,setTimeout(function(){e.width=e.avarNodeOrgSize.width,e.height=e.avarNodeOrgSize.height},1e3),this.Play_with_message.getChildByName("lb_username").getComponent(cc.Label).string=l.user.name,this.Play_with_message.getChildByName("user_score").getComponent(cc.Label).string=l.utils.localizeNumber(l.user.score),t=l.language.currentLangFile.message.sendMessageScore,n=t.content(l.user.name),r=t.cta(),[4,this.initPayload(this.Play_with_message,n,r)];case 1:return o=i.sent(),[4,FBInstant.updateAsync(o)];case 2:return i.sent(),[3,4];case 3:return a=i.sent(),_log("sendMessageScore",a),[3,4];case 4:return[2]}})})},a([d(cc.Node)],t.prototype,"Play_with_message",void 0),a([u],t)}(cc.Component);n.default=f,cc._RF.pop()},{"../all_modules":"all_modules"}],promo:[function(e,t,n){"use strict";cc._RF.push(t,"5f419QUCJpFpIXG+g1mRUPq","promo"),n.__esModule=!0,n.promo=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a={isPromoAvailable:!1,init:function(){r.promo.isPromoAvailable=r.utilsFB.isSupportedAPI("switchGameAsync")&&r.configs.isShowPromoGames,cc.find("Canvas/layer_leaderboard/content_bg/bottom_container/promo_panel").active=r.promo.isPromoAvailable,r.leaderboard.adjustHeight(r.promo.isPromoAvailable),cc.find("Canvas/layer_challenge_friend/promo_panel").active=r.promo.isPromoAvailable;var e=cc.find("Canvas/layer_leaderboard/content_bg/bottom_container/promo_panel");this.renderButtonByIcon(e);var t=cc.find("Canvas/layer_challenge_friend/promo_panel");this.renderButtonByIcon(t)},renderButtonByIcon:function(e){e&&r.configs.listIdPromoGame&&e.children.map(function(e,t){r.utils.addButtonComp(e,function(){r.utilsFB.log("ev_click_button_promo_game",1,{Position:t}),r.promo.switchPromoGame(r.configs.listIdPromoGame[t])})})},switchPromoGame:function(e){FBInstant.switchGameAsync(e).catch(function(e){console("switchPromoGame: ",e)})}};n.promo=a,cc._RF.pop()},{"../all_modules":"all_modules"}],remove_new_item:[function(e,t,n){"use strict";cc._RF.push(t,"7815fKi0VVLmIezxShqRwTD","remove_new_item"),n.__esModule=!0,n.removeNewItem=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a={removeNewItemTimeLeft:0,init:function(){var e=this;r.login.addLoginDataField("removeNewItemTimeLeft"),r.login.addCallback(function(t){e.removeNewItemTimeLeft=t.removeNewItemTimeLeft||(t.isNewUser?r.configs.freeRemoveNewItemForNewUser:0),e.updateButton(),t.isNewUser&&r.data.saveData({removeNewItemTimeLeft:r.configs.freeRemoveNewItemForNewUser})})},btnClick:function(){this.removeNewItemTimeLeft?this.remove():this.getRemove()},remove:function(){r.ui.showNagScreen(),this.fx(function(){r.ui.hideNagScreen(),r.game.genNewItem()}),this.removeNewItemTimeLeft--,r.data.saveData({removeNewItemTimeLeft:this.removeNewItemTimeLeft}),this.updateButton()},fx:function(e){var t=cc.find("Canvas/play_area/new_item_container/new_item/item_types").children.find(function(e){return e.active}),n=cc.find("Canvas/play_area/fx_container"),o=r.utils.copyNodeTo(t,n);r.utils.setGlobalPositionToNode(o,t),t.active=!1;var a=r.utils.getGlobalPosition(cc.find("Canvas/play_area/botBar/remove_new_item")),i=r.utils.global2LocalPosDiff(o,a.x,a.y);o.runAction(cc.sequence(cc.spawn(cc.moveBy(.2,i),cc.scaleTo(.2,0).easing(cc.easeIn(5))),cc.callFunc(function(){e&&e(),o.removeFromParent(!0)})))},getRemove:function(){var e=this;r.video.showVideo(function(){e.removeNewItemTimeLeft=r.configs.removeNewItemTimeEachVideo,e.updateButton(),r.data.saveData({removeNewItemTimeLeft:e.removeNewItemTimeLeft})},function(e){r.ui.showAlert("somethingWrong"),console.log(e)},"get_remove_item")},updateButton:function(){var e=cc.find("Canvas/play_area/botBar/remove_new_item/badge/removeNewItem_left");e.active=this.removeNewItemTimeLeft,r.utils.setLabelText(e,this.removeNewItemTimeLeft+""),cc.find("Canvas/play_area/botBar/remove_new_item/recbinItem").opacity=this.removeNewItemTimeLeft?255:128,cc.find("Canvas/play_area/botBar/remove_new_item/badge/video").active=!this.removeNewItemTimeLeft}};n.removeNewItem=a,cc._RF.pop()},{"../all_modules":"all_modules"}],share:[function(e,t,n){"use strict";cc._RF.push(t,"a24f68jMHpCDam8IMOs+/h+","share");var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{l(r.next(e))}catch(t){a(t)}}function c(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(i,c)}l((r=r.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(e){return function(t){return l([e,t])}}function l(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(c){a=[6,c],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var l=cc._decorator,s=l.ccclass,u=l.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.SharePhoto_Normal=null,t}return o(t,e),t.prototype.initBase64Picture=function(e){return i(this,void 0,void 0,function(){var t,n,r,o,a,i,l,s,u,d,f,p,g,m;return c(this,function(){for(e.activeInHierarchy||(e.parent.active=!0,e.parent.parent.active=!0),t=new cc.Node,e.addChild(t),t.position=e.position,(n=t.addComponent(cc.Camera)).cullingMask=4294967295,(r=new cc.RenderTexture).initWithSize(e.width,e.height),n.targetTexture=r,n.zoomRatio=2.5,o=r.width,a=r.height,(i=document.createElement("canvas")).width=o,i.height=a,l=i.getContext("2d"),n.render(e),s=r.readPixels(),u=4*o,d=0;d<a;d++)f=a-1-d,p=new Uint8ClampedArray(s.buffer,f*o*4,u),g=new ImageData(p,o,1),l.putImageData(g,0,d);return m=i.toDataURL(),_log(e,r,n,i),setTimeout(function(){return e.parent.active=!1},2e3),[2,m]})})},t.prototype.initPayload=function(e,t,n){return i(this,void 0,void 0,function(){return c(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.initBase64Picture(e)];case 1:return[2,{intent:"SHARE",image:r.sent(),text:t,data:n}];case 2:throw r.sent();case 3:return[2]}})})},t.prototype.sharePostNormal=function(e){return i(this,void 0,void 0,function(){var t,n;return c(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,this.initPayload(this.SharePhoto_Normal,"",{isFromSharedPos:!0,shareCode:e})];case 1:return t=r.sent(),_log(t),[4,FBInstant.shareAsync(t)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),_log(n),[3,4];case 4:return[2]}})})},a([u(cc.Node)],t.prototype,"SharePhoto_Normal",void 0),a([s],t)}(cc.Component);n.default=d,cc._RF.pop()},{}],social:[function(e,t,n){"use strict";cc._RF.push(t,"62bd8aVFtZKTbJNiqGHzADB","social"),n.__esModule=!0,n.social=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=r?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules")),o=i(e("../social/share")),a=i(e("../social/message"));function i(e){return e&&e.__esModule?e:{default:e}}function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}var l={init:function(){var e=this;r.login.addLoginDataField("subscribeInfo"),r.login.addLoginDataField("shortcutInfo"),r.login.addCallback(function(t){e.subscribeInfo=t.hasOwnProperty("subscribeInfo")?t.subscribeInfo:5,e.shortcutInfo=t.hasOwnProperty("shortcutInfo")?t.shortcutInfo:5})},share:function(e,t){r.utils.setLabelText(cc.find("Canvas/shares/sharepicture/label_score"),r.utils.localizeNumber(e)),cc.find("Canvas/shares").getComponent(o.default).sharePostNormal(t)},sendMessageAfterQuit:function(){cc.find("Canvas/messages").getComponent(a.default).sendMessageScore()},askBotSubscribe:function(e){var t=this,n=function(){return e&&e()};return window.FBInstant?r.utilsFB.isSupportedAPI("player.canSubscribeBotAsync")&&r.utilsFB.isSupportedAPI("player.subscribeBotAsync")?"accepted"==this.subscribeInfo||this.subscribeInfo<=0?n():(this.subscribeInfo--,r.data.saveData({subscribeInfo:this.subscribeInfo}),void FBInstant.player.canSubscribeBotAsync().then(function(e){if(!e)return n()||_log(" askBotSubscribe :: can_subscribe = "+e+" ");FBInstant.player.subscribeBotAsync().then(function(){t.subscribeInfo="accepted",r.data.saveData({subscribeInfo:t.subscribeInfo}),n()}).catch(function(){return n()})}).catch(function(e){return n()||_log(" askBotSubscribe :: canSubscribeBotAsync().then(fail) => ",e)})):n()||_log(" askBotSubscribe :: isSupportedAPI > not supported"):n()},askShortcut:function(e){var t=this,n=function(){return e&&e()};return window.FBInstant&&r.utilsFB.isSupportedAPI("canCreateShortcutAsync")&&r.utilsFB.isSupportedAPI("createShortcutAsync")?"accepted"==this.shortcutInfo||this.shortcutInfo<=0?n():(this.shortcutInfo--,r.data.saveData({shortcutInfo:this.shortcutInfo}),void FBInstant.canCreateShortcutAsync().then(function(e){if(!e)return n();FBInstant.createShortcutAsync().then(function(){t.shortcutInfo="accepted",r.data.saveData({shortcutInfo:t.shortcutInfo}),n()}).catch(function(e){return n()||_log(" createShortcutAsync :: ",e)})}).catch(function(e){return n()||_log(" canCreateShortcutAsync :: ",e)})):n()},postSessionScore:function(){window.FBInstant&&(r.user.score&&FBInstant.postSessionScore(r.user.score),_log(" postSessionScore called score = "+r.user.score),r.user.score>(r.game.bestSessionScore||0)&&(r.game.bestSessionScore=r.user.score))},createContext:function(e,t,n){if(!window.FBInstant)return t&&t();var r=function(e,t){e&&_log("createContext Success ====> ",e),t&&_log("createContext Fail  ====> ",t)};FBInstant.context.createAsync(e).then(function(){t&&t(),r("success")},function(e){n&&n(e),r("fail",e)})},invite:function(e){var t=this;try{FBInstant.context.chooseAsync().then(function(){t.sendMessageAfterQuit(),r.ui.hideLayer("layer_leaderboard"),r.gameFlow.replay(),e&&e(FBInstant.context.getID())}).catch(function(t){_log(t),e&&e()})}catch(n){_log(n),e&&e()}}};n.social=l,cc._RF.pop()},{"../all_modules":"all_modules","../social/message":"message","../social/share":"share"}],ui:[function(e,t,n){"use strict";cc._RF.push(t,"369ectLwYFG4Ku+YDu4KaLJ","ui"),n.__esModule=!0,n.ui=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a={hideNagTimer:null,hideLoadingRealServerTimer:null,init:function(){r.ui.initButtonHandler(),this.adjustAllLayerSizes()},adjustAllLayerSizes:function(){cc.winSize.width/cc.winSize.height<.5625&&(cc.find("Canvas").getComponent(cc.Canvas).fitWidth=!0,cc.find("Canvas").getComponent(cc.Canvas).fitHeight=!1);var e=["sample_nodes"];cc.find("Canvas").children.map(function(t){e.includes(t.name)||(t.width=cc.winSize.width,t.height=cc.winSize.height)})},initButtonHandler:function(){r.utils.addButtonComp(cc.find("Canvas/layer_home/but_play"),function(){r.ui.hideLayer("layer_home"),cc.find("Canvas/play_area/pause_button_bg").active=!0,cc.find("Canvas/play_area/lives_left").active=!0,r.gameFlow.replay()}),r.utils.addButtonComp(cc.find("Canvas/play_area/pause_button_bg/but_pause"),function(){r.gameFlow.pause(),r.ui.showLayer("layer_pause")}),r.utils.addButtonComp(cc.find("Canvas/layer_game_over/but_replay"),function(){r.ui.hideLayer("layer_game_over"),r.gameFlow.replay()}),r.utils.addButtonComp(cc.find("Canvas/layer_pause/but_replay"),function(){r.ui.hideLayer("layer_pause"),r.gameFlow.replay()}),r.utils.addButtonComp(cc.find("Canvas/layer_pause/but_resume"),function(){r.gameFlow.resume(),r.ui.hideLayer("layer_pause")})},showLayer:function(e){_log("showLayer("+e+")");var t=cc.find("Canvas/"+e);t&&(t.active=!0)},hideLayer:function(e){_log("hideLayer("+e+")");var t=cc.find("Canvas/"+e);t&&(t.active=!1)},showAlert:function(e,t){r.ui.showLayer("layer_alert"),r.language.setLabelDataAndRender(cc.find("Canvas/layer_alert/content_bg/label_message"),e),r.ui.alertCloseCallback=t},showLoading:function(){r.ui.showLayer("layer_loading"),r.ui.hideLoadingTimer&&clearTimeout(r.ui.hideLoadingTimer),r.ui.hideLoadingTimer=setTimeout(function(){return r.ui.hideLoading()},1e4)},hideLoading:function(){r.ui.hideLayer("layer_loading"),r.ui.hideLoadingTimer&&clearTimeout(r.ui.hideLoadingTimer)},showNagScreen:function(){cc.find("Canvas/nag_screen").active=!0,r.ui.hideNagTimer&&clearTimeout(r.ui.hideNagTimer),r.ui.hideNagTimer=setTimeout(function(){return r.ui.hideNagScreen()},1e4)},hideNagScreen:function(){cc.find("Canvas/nag_screen").active=!1,r.ui.hideNagTimer&&clearTimeout(r.ui.hideNagTimer)},disableButton:function(e){e.getComponent(cc.Button)||_log("KHoong ton tai button component"),e.getComponent(cc.Button)&&(e.getComponent(cc.Button).enabled=!1),e.opacity=parseInt(76.5)},enableButton:function(e){e.getComponent(cc.Button)&&(e.getComponent(cc.Button).enabled=!0),e.opacity=255},updateScore:function(e){_log(" updateScore called !!!! "),e=e||r.user.score;var t=cc.find("Canvas/play_area/pause_button_bg/label_score");t.runAction(cc.sequence(cc.scaleTo(.1,1.5),cc.callFunc(function(){return r.utils.setLabelText(t,r.utils.localizeNumber(e)+"m")}),cc.scaleTo(.17,1))),r.utils.setLabelText(cc.find("Canvas/layer_game_over/score_bg/label_score"),r.utils.localizeNumber(e)+"m");var n=_max(r.user.bestScore,e);r.utils.setLabelText(cc.find("Canvas/layer_home/highest_tower/label_best_score"),r.utils.localizeNumber(n)+"m"),r.utils.setLabelText(cc.find("Canvas/layer_game_over/label_best_score"),r.utils.localizeNumber(n)+"m")}};n.ui=a,cc._RF.pop()},{"../all_modules":"all_modules"}],"use_v2.1-2.2.1_cc.Toggle_event":[function(e,t){"use strict";cc._RF.push(t,"63196hPV7FGHZUSYhQK0GHg","use_v2.1-2.2.1_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_isChecked=!0),cc._RF.pop()},{}],user:[function(e,t,n){"use strict";cc._RF.push(t,"3fe9fn4VtFG/bmP6vRVZhC9","user"),n.__esModule=!0,n.user=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a={id:0,name:0,score:0,bestScore:0,init:function(){window.FBInstant?(r.user.id=FBInstant.player.getID(),r.user.name=FBInstant.player.getName(),r.user.photo=FBInstant.player.getPhoto()):(r.user.id="xxxxaa111",r.user.name="Tkgiet",r.user.photo="https://developer.mozilla.org/static/img/opengraph-logo.72382e605ce3.png"),cc.assetManager.loadRemote(r.user.photo,function(e,t){e||(r.user.avatarSpriteFrame=new cc.SpriteFrame(t))})},initNewUser:function(e){Object.assign(e,{LoginTime:0,PlayerExp:0,PlayerLevel:0}),r.data.saveData(e)}};n.user=a,cc._RF.pop()},{"../all_modules":"all_modules"}],utils_facebook:[function(e,t,n){"use strict";cc._RF.push(t,"6352baeP59CYZXDM4grJoBf","utils_facebook"),n.__esModule=!0,n.utilsFB=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a={init:function(){r.utilsFB.startLogSessionTime(),window.FBInstant&&(FBInstant.onPause(function(){}),window.fbSupportedAPIs=FBInstant.getSupportedAPIs())},log:function(e,t,n){void 0===t&&(t=1),window.FBInstant&&FBInstant.logEvent(e,t,n)},setSessionId:function(e){window.FBInstant&&FBInstant.setSessionData({player_id:e})},isSupportedAPI:function(e){return!!window.FBInstant&&-1!=FBInstant.getSupportedAPIs().indexOf(e)},startLogSessionTime:function(){var e=function(e){r.utilsFB.log("ev_session_time",1,{timePassed:e})};e(0);var t=0;setInterval(function(){e(t+=30)},3e4)}};n.utilsFB=a,cc._RF.pop()},{"../all_modules":"all_modules"}],utils_instant:[function(e,t){"use strict";cc._RF.push(t,"e9a52yRTSdH1owimWkbkTfe","utils_instant"),window._NO_CONSOLE_LOG=!0,window._soundVolume=1,window._isANDROID=cc.sys.os==cc.sys.OS_ANDROID,window._isIOS=cc.sys.os==cc.sys.OS_IOS,window._max=Math.max,window._min=Math.min,window._round=Math.round,window._floor=Math.floor,window._ceil=Math.ceil,window._abs=Math.abs,window._random=Math.random,window._sqrt=Math.sqrt,window._atan2=Math.atan2,window._PI=Math.PI,window._removeArrItem=function(e,t){var n=e.indexOf(t);if(-1!=n)return e.splice(n,1),!0},window._time=function(){return(new Date).getTime()},window._isString=function(e){return"string"==typeof e},window._isFunction=function(e){return e&&"[object Function]"==={}.toString.call(e)},window._log=function(){if(!window._NO_CONSOLE_LOG)try{var e;(e=console).log.apply(e,arguments)}catch(t){}},cc._RF.pop()},{}],utils:[function(e,t,n){"use strict";cc._RF.push(t,"9f320CgfyZBvpJvky2f4A6n","utils"),n.__esModule=!0,n.utils=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}function a(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=i(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function i(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l=1e5,s={textureCaches:{},init:function(){r.utils.canvasNode=cc.find("Canvas")},setTimeout:function(e,t){void 0===t&&(t=0);var n={_id:l++,__instanceId:l,callback:function(){e(n)}};return cc.director.getScheduler().schedule(n.callback,n,t/1e3,0,0,!1),n},clearTimeout:function(e){e&&e._id&&e.callback&&cc.director.getScheduler().unschedule(e.callback,e)},addButtonComp:function(e,t,n,o){void 0===n&&(n=!0),void 0===o&&(o=!0),setTimeout(function(){e.getComponent("free_button_comp")||e.addComponent("free_button_comp");var o=e.addComponent(cc.Button);o.transition=n?cc.Button.Transition.SCALE:null;var a=new cc.Component.EventHandler;a.target=e,a.component="free_button_comp",a.handler="freeHandler",o.clickEvents.push(a),e.freeButtonHandlerFunc=function(){t(),r.audio.playSoundClickButton()}})},getNodePath:function(e){for(var t=[e.name],n=e.parent,r=0;n&&r++<50&&n.parent;)t.push(n.name),n=n.parent;return t.reverse().join("/")},getChildByPath:function(e,t){try{var n=e;return t.split("/").map(function(e){n=n.getChildByName(e)}),n}catch(r){return console.warn(" Error calling getChildByPath("+t+") : "+r.message+" "),null}},getComponentName:function(e){return e.split("<")[1].replace(">","")},setOrgPos:function(e){e&&(e.orgPos||(e.orgPos=e.getPosition()),e.setPosition(e.orgPos))},getGlobalPosition:function(e){var t=e.parent,n=e.x,r=e.y,o=0;for(t||_log(" parent=null // node = "+e+" ");t&&"Canvas"!=t.name&&o++<100;)n=n*t.scaleX+t.x,r=r*t.scaleY+t.y,t=t.parent;return cc.v2(n,r)},global2LocalPosDiff:function(e,t,n){for(var r=e.parent,o=[],a=0;"Canvas"!=r.name&&a++<100;)o.push(r),r=r.parent;var i=t,c=n;return o.reverse().map(function(e){i=(i-e.x)/e.scaleX,c=(c-e.y)/e.scaleY}),cc.v2(i-e.x,c-e.y)},setGlobalPositionToNode:function(e,t){var n=r.utils.getGlobalPosition(t),o=r.utils.global2LocalPosDiff(e,n.x,n.y);return e.x+=o.x,e.y+=o.y,n},randomArrItem:function(e,t){void 0===t&&(t=!1);var n=_floor(_random()*e.length);return t?e.splice(n,1)[0]:e[n]},randomObjectProp:function(e,t){void 0===t&&(t=!1);var n=Array.from(Object.keys(e)),o=r.utils.randomArrItem(n),a=e[o];return t&&delete e[o],a},randomItemFromRatioSet:function(e){var t=0,n=[];e.map(function(e){t+=e.ratio,n.push(t)});var r=parseInt(_random()*t),o=0;return n.some(function(e,t){if(r<e)return o=t,!0}),e[o]},secondsToTime:function(e){return{days:Math.floor(e/86400),hours:Math.floor(e%86400/3600),minutes:Math.floor(e%3600/60),seconds:e%60}},secondsToTimeString:function(e){var t=this.secondsToTime(e),n=t.days,r=t.hours,o=t.minutes,a=t.seconds;return n>0?n+" day"+(n>1?"s":""):r>0?r+" hr"+(r>1?"s":""):o>0?o+" min"+(o>1?"s":""):(a||0)+" sec"+(a>1?"s":"")},secondsToTimeCountdown:function(e){if(e<=0)return"00:00";var t=this.secondsToTime(e),n=t.days,r=t.hours,o=t.minutes,a=t.seconds;if(n>0)return n+" day"+(n>1?"s":"");var i="";return r>0&&(i=("0"+r).slice(-2)+":"),(i+=("0"+o).slice(-2)+":")+("0"+a).slice(-2)},setLabelCountDownTimer:function(e,t,n,o){var a=e;_isString(a)&&(a=cc.find(a)),a.countDownTimerVar&&clearInterval(a.countDownTimerVar);var i=function(){if(a.parent){var e=_time(),i=t-e,c=r.utils.secondsToTimeCountdown(_floor(i/1e3)),l=(o||"xxx").replace("xxx",c);r.utils.setLabelText(a,l),i<=0&&(clearInterval(a.countDownTimerVar),n&&n())}else clearInterval(a.countDownTimerVar)};a.countDownTimerVar=setInterval(i,500),i()},waitToRun:function(e,t,n,o,a,i){void 0===n&&(n=window),void 0===o&&(o=.1);var c=!1,l=setInterval(function(){if(t.includes("()")){if(!n[t.replace("()","")]())return}else if(!n[t])return;clearInterval(l),c=!0,e()},1e3*o);a&&r.utils.setTimeout(function(){clearInterval(l),i&&!c&&i()},1e3*a)},extendObj:function(e,t,n){n.map(function(n){t[n]=e[n]})},setNodeProps:function(e,t,n,r,o,a){t&&(e.width=t),n&&(e.height=n),r&&(e.x=r),o&&(e.y=o),a&&(e.scale=a)},preloadImage:function(e,t){if(r.utils.textureCaches[e])return t&&t(r.utils.textureCaches[e]);cc.loader.loadRes(e,cc.SpriteFrame,function(n,o){n?t&&t(!1):(r.utils.textureCaches[e]=o,t&&t(o))})},copyTexture:function(e,t){(t.getComponent(cc.Sprite)||t.addComponent(cc.Sprite)).spriteFrame=e.getComponent(cc.Sprite).spriteFrame},setNodeImgFromUrl:function(e,t){e.isTextureFromURL=!0,r.utils.textureCaches[t]||(r.utils.textureCaches[t]=new cc.SpriteFrame(t)),r.utils.setNodeImgFromSpriteFrame(e,r.utils.textureCaches[t])},setNodeImgFromResources:function(e,t,n,o){void 0===n&&(n=!1),e.isTextureFromResource=!0,e.currentTexturePath=t,r.utils.textureCaches[t]?(e.getComponent(cc.Sprite).enabled=!0,r.utils.setNodeImgFromSpriteFrame(e,r.utils.textureCaches[t],!n,n),o&&o()):cc.loader.loadRes(t,cc.SpriteFrame,function(a,i){a||(r.utils.textureCaches[t]=i,e.currentTexturePath==t&&(e.getComponent(cc.Sprite).enabled=!0,r.utils.setNodeImgFromSpriteFrame(e,r.utils.textureCaches[t],!n,n),o&&o()))})},setNodeImgFromSpriteFrame:function(e,t,n,o){void 0===n&&(n=!0),void 0===o&&(o=!1);var a=e.width,i=e.height;e.getComponent(cc.Sprite)||e.addComponent(cc.Sprite),r.utils.waitToRun(function(){if(e.getComponent(cc.Sprite).spriteFrame=t,n?(e.width=0!=a?a:t._originalSize.width,e.height=0!=i?i:t._originalSize.height):(0!=t._originalSize.width&&(e.width=t._originalSize.width),0!=t._originalSize.height&&(e.height=t._originalSize.height)),o){var r=e.getComponent(cc.Sprite).spriteFrame;e.width=r._originalSize.width,e.height=r._originalSize.height}},"textureLoaded()",t)},setNodeImg:function(e,t,n,o){if(void 0===n&&(n=!0),void 0===o&&(o=!1),"string"==typeof t)this.isURL(t)?r.utils.setNodeImgFromUrl(e,t):r.utils.setNodeImgFromResources(e,t,o);else if(t instanceof cc.SpriteFrame)r.utils.setNodeImgFromSpriteFrame(e,t,n,o);else if(t instanceof cc.Node){var a=t.getComponent(cc.Sprite);if(!a)return;r.utils.setNodeImgFromSpriteFrame(e,a.spriteFrame,n,o)}},setLabelText:function(e,t){e&&(e.getComponent(cc.Label).string=t)},setLabelTextBigNumber:function(e,t){e&&(isNaN(t)&&(t=0),e.getComponent(cc.Label).string=r.utils.formatCurrency(t,999999999999999))},setLabelTextPrice:function(e,t,n){if(e){var o=_isString(t)&&t.startsWith("+"),a=o?parseInt(t.replace("+","")):t,i=r.utils.formatCurrency(a,n);e.getComponent(cc.Label).string=(o?"+":"")+i}},setLabelTextShotcut:function(e,t){if(e){if(!t.length)return;var n=t.length>6?t.slice(0,6):t;e.getComponent(cc.Label).string=n+"..."}},moveNodeTo:function(e,t,n){void 0===n&&(n=!1);var r=n?cc.instantiate(e):e;return t&&r.parent!=t&&(r.removeFromParent(!1),t.addChild(r)),r},copyNodeTo:function(e,t){var n=r.utils.moveNodeTo(e,t,!0),o=e.getComponentsInChildren(cc.Sprite),a=n.getComponentsInChildren(cc.Sprite);return o.map(function(e,t){var n=e.node,o=a[t].node;r.utils.extendObj(n,o,["width","height"]),n.onTouchEnd&&o.on("touchend",n.onTouchEnd)}),n},prefabToNode:function(e){return cc.instantiate(r.prefabList[e])},preloadPrefabToNode:function(e,t,n){var o=r.utils.prefabToNode(e);o.name=t,o.parent=n,o.setPosition(0,0),o.active=!1},formatNumber:function(e){return e.toLocaleString("en")},formatCurrency:function(e,t){var n=Math.floor(e),r="";if(n>t)for(var o,i=a(["K","M","B","T","aa","ab","ad","ae","af"]);!(o=i()).done;){var c=o.value;if((n/=1e3)<t){r=c;break}}return n.toFixed(0).replace(",",".").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")+r},isURL:function(e){return!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(e)},singleTouchSet:function(e,t,n,r){var o=cc.winSize.width/2,a=cc.winSize.height/2,i=function(e,t){var n=t.touch.getLocation();e(cc.v2(n.x-o,n.y-a),t)};e.on("touchstart",function(n){e.touchingID||(e.touchingID=n.touch._id+1,t&&i(t,n))}),n&&e.on("touchmove",function(t){t.touch._id+1==e.touchingID&&n&&i(n,t)});var c=function(t){t.touch._id+1==e.touchingID&&(e.touchingID=null,r&&i(r,t))};e.on("touchend",c),e.on("touchcancel",c)},removeTouchHandler:function(e){e.isDraggable=!1,e.touchStartHandlerArr=e.touchMoveHandlerArr=e.touchEndHandlerArr=null,e.off("touchstart"),e.off("touchend"),e.off("touchmove"),e.off("touchcancel")},localizeNumber:function(e){var t=".";switch(window.FBInstant?FBInstant.getLocale():"en_US"){case"en_US":case"en_GB":case"th_TH":t=",";break;case"fr_FR":case"fr_CA":case"ru_RU":t=" ";break;case"pl_PL":case"it_IT":case"hu_HU":t=""}for(var n="",r=e,o=0;r>=10;){o>0&&o%3==0&&(n=t+n);var a=r%10;n=a+""+n,r=(r-a)/10,o++}return o>0&&o%3==0&&(n=t+n),r+""+n}};n.utils=s,cc._RF.pop()},{"../all_modules":"all_modules"}],video:[function(e,t,n){"use strict";cc._RF.push(t,"676949Lh3BPDLrQ2WbtlHfv","video"),n.__esModule=!0,n.video=void 0;var r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=o();if(t&&t.has(e))return t.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}(e("../all_modules"));function o(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return o=function(){return e},e}var a={isAvailable:!1,loadingVideo:!1,rewardedVideo:null,init:function(){var e=this;window.FBInstant||(this.isAvailable=!0),r.video.preloadVideo(function(){_log("PRELOAD VIDEO OK"),e.isAvailable=!0},function(e){_log("PRELOAD VIDEO ERROR",e)})},preloadVideo:function(e,t){window.FBInstant?r.utilsFB.isSupportedAPI("getRewardedVideoAsync")?r.video.loadingVideo?t&&t({code:"LOADING"}):(r.video.loadingVideo=!0,FBInstant.getRewardedVideoAsync(r.configs.videoRewardId).then(function(n){n.loadAsync().then(function(){r.video.rewardedVideo=n,r.video.loadingVideo=!1,e&&e()}).catch(function(e){r.video.rewardedVideo=null,r.video.loadingVideo=!1,t&&t(e)})}).catch(function(e){r.video.rewardedVideo=null,r.video.loadingVideo=!1,t&&t(e)})):t&&t({code:"NOT_SUPPORTED"}):t&&t({code:"OFFLINE"})},showVideo:function(e,t,n){void 0===n&&(n="");var o=function(){r.ui.hideLoading(),e&&e()},a=function(e){r.ui.hideLoading(),t&&t(e)};if(r.ui.showLoading(),!window.FBInstant)return o();r.video.rewardedVideo?(r.utilsFB.log("ev_video_click_show"),r.video.rewardedVideo.showAsync().then(function(){r.utilsFB.log("ev_watch_video_success",1,{}),r.utilsFB.log("Ads-Total-Video",1,{videoPos:n}),r.utilsFB.log("Ads-Total"),o(),r.video.preloadVideo()}).catch(function(e){console.warn(" error showing video ",e),r.video.isErrRewardNotCompleted(e)?r.utilsFB.log("ev_video_err_reward_not_completed"):r.utilsFB.log("ev_video_err_other"),r.video.preloadVideo(),a(e)})):r.video.loadingVideo?r.utils.setTimeout(function(){return r.video.showVideo(o,a,n)},200):a({code:"VIDEO_IS_NULL"})},isErrRewardNotCompleted:function(e){return"USER_INPUT"==e.code&&"Reward not completed"==e.message}};n.video=a,cc._RF.pop()},{"../all_modules":"all_modules"}]},{},["all_modules","canvas_init","configs","block_collider","control","map","map_visual","data","game","game_flow","get7Video","load_optimize","login","remove_new_item","user","challenge","leaderboard","message","promo","share","social","fx","ui","audio","free_button_comp","inter_ad","md5","utils","utils_facebook","utils_instant","video","use_v2.1-2.2.1_cc.Toggle_event"]);